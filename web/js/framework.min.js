!function(){var r=function(){var e="function"==typeof require&&require,r=function(i,o,u){o||(o=0);var n=r.resolve(i,o),t=r.m[o][n];if(!t&&e){if(t=e(n))return t}else if(t&&t.c&&(o=t.c,n=t.m,t=r.m[o][t.m],!t))throw new Error('failed to require "'+n+'" from '+o);if(!t)throw new Error('failed to require "'+i+'" from '+u);return t.exports||(t.exports={},t.call(t.exports,t,t.exports,r.relative(n,o))),t.exports};return r.resolve=function(e,n){var i=e,t=e+".js",o=e+"/index.js";return r.m[n][t]&&t?t:r.m[n][o]&&o?o:i},r.relative=function(e,t){return function(n){if("."!=n.charAt(0))return r(n,t,e);var o=e.split("/"),f=n.split("/");o.pop();for(var i=0;i<f.length;i++){var u=f[i];".."==u?o.pop():"."!=u&&o.push(u)}return r(o.join("/"),t,e)}},r}();r.m=[],r.m[0]={radar_client:function(module){module.exports=window.RadarClient},minilog:function(module){module.exports=window.Minilog},ember:function(module){module.exports=window.Ember},handlebars:function(module){module.exports=window.Handlebars},i18n:function(module){module.exports=window.I18n},jquery:function(module){module.exports=window.jQuery},reporter:function(module){module.exports=window.ZendeskReporter},underscore:function(module){module.exports=window._},microee:{c:1,m:"index.js"},"zat.js":function(module,exports,require){"use strict";var $=require("jquery");module.exports=Object.seal({isEnabled:function(){return $("script[data-zat-enabled]").data("zatEnabled")||!1}})},"i18n.js":function(module){"use strict";var I18n={t:function(key,context,defaultValue){var EmberI18n=window.I18n;return"undefined"!=typeof EmberI18n&&null!=EmberI18n.translations[key]?EmberI18n.t(key,context):defaultValue}};module.exports=I18n},"site.js":function(module){"use strict";module.exports={NAV_BAR:"nav_bar",TICKET_SIDEBAR:"ticket_sidebar",NEW_TICKET_SIDEBAR:"new_ticket_sidebar",USER_SIDEBAR:"user_sidebar",ORGANIZATION_SIDEBAR:"organization_sidebar",TOP_BAR:"top_bar",BACKGROUND:"background"}},"index.js":function(module,exports,require){"use strict";function defineApp(source){return source?require("app/legacy").extend(source):require("app/iframe").extend({})}var _utils=require("utils"),$=require("jquery"),_=require("underscore"),logger=require("log/base").logger,SDKClient=require("zaf_sdk_client"),globalRequire=window.require;_utils.assert("jQuery is not available",null!==$),_utils.assert("Underscore is not available",null!==_);var InstalledApp=require("installed_app"),AppScope=require("app_scope");SDKClient.init(),globalRequire&&globalRequire.cache&&(globalRequire.cache["apps/framework/app_scope"]=AppScope.create()),logger.time("Initialize Apps"),module.exports=_.extend(window.ZendeskApps||{},{ApiRouter:require("api_router"),AppRuntime:require("app_runtime"),AppScope:AppScope,AppContainerView:require("app_container/base_v2"),AppViewV2:require("app_view/base_v2"),BackgroundAppRuntime:require("background_app_runtime"),CoreServices:require("core_services"),defineApp:defineApp,EventManager:require("events/event_manager"),RequestManager:require("requests/request_manager"),InstalledApp:InstalledApp,installedAppsFor:InstalledApp.forSite.bind(InstalledApp),Logger:logger,Site:require("site"),sortAppsForSite:InstalledApp.sortAppsForSite.bind(InstalledApp),ViewEvent:require("events/view"),ZAT:require("zat")}),"function"==typeof module.exports.trigger&&module.exports.trigger("loaded")},"utils.js":function(module,exports,require){"use strict";function isPath(key){return"string"==typeof key&&-1!==key.indexOf(".")}function getPath(obj,path){return path.split(".").reduce(function(memo,key){return null==memo?null:memo[key]},obj)}function setPathHelper(obj,path,val,onMissing){var keys=path.split("."),lastKey=keys.pop();return keys.forEach(function(key){obj.hasOwnProperty(key)||onMissing(obj,key),obj=obj[key]}),set(obj,lastKey,val)}function bindWithArgs(context,fn,args){return fn.apply.bind(fn,context,args)}function fmt(str,formats){var cachedFormats=formats;if(!_.isArray(cachedFormats)||arguments.length>2){cachedFormats=new Array(arguments.length-1);for(var i=1,l=arguments.length;l>i;i++)cachedFormats[i-1]=arguments[i]}var idx=0;return str.replace(/%@([0-9]+)?/g,function(s,argIndex){return argIndex=argIndex?parseInt(argIndex,10)-1:idx++,s=cachedFormats[argIndex],null===s?"(null)":void 0===s?"":_.isFunction(s.toString)?s.toString():s})}function runLater(context,fn){var args=slice.call(arguments,2);return setTimeout(bindWithArgs(context,fn,args),1)}function setPath_p(obj,path,val){return assert("You need to provide an object to `setPath_p`.",null!=obj),assert("You need to provide a path to `setPath_p`.",null!=path),setPathHelper(obj,path,val,function(obj,key){obj[key]={}})}function noop(){return this}function isFunction(value){return"function"==typeof value}function appendParams(url,params){var hashIndex=url.indexOf("#"),urlBeforeHash=hashIndex>0?url.substring(0,hashIndex):url,hasParams=urlBeforeHash.indexOf("?")>0,divider=hasParams>0?"&":"?",urlWithParams=urlBeforeHash+divider+params;return hashIndex>0?urlWithParams+url.substring(hashIndex):urlWithParams}function flattenArray(array){return array.map(function(elem){return _.isObject(elem)?flattenObject(elem):elem})}function flattenObject(obj){var result,key,flatObject={};for(key in obj)obj.hasOwnProperty(key)&&(result=_.result(obj,key),_.isArray(result)?result=flattenArray(result):_.isObject(result)&&(result=flattenObject(result)),flatObject[key]=result);return flatObject}function assert(desc,test){if(isFunction(test)&&(test=test()!==!1),!test)throw new Error(fmt("assertion failed: %@",desc))}function wrap(fnTarget,fnSource){return function(){var origSuper=this._super;this._super=fnTarget;var result=fnSource.apply(this,arguments);return this._super=origSuper,result}}function extend(obj){if(arguments.length<2)return obj;for(var key,src,args=slice.call(arguments,1),i=0;i<args.length;i++){src=args[i],"function"==typeof src&&(src=src.prototype);for(key in src)src.hasOwnProperty(key)&&(obj[key]="function"==typeof obj[key]&&"function"==typeof src[key]?wrap(obj[key],src[key]):src[key])}}function inherit(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})}function extendAppAndWarn(app,obj,overwritesPrototype){var appPrototype=Object.getPrototypeOf(app),conflicts=_.intersection(Object.keys(appPrototype),Object.keys(obj));if(conflicts.length){var error={message:fmt("The following framework methods were overwritten by the app: %@. ",conflicts.join(", "))+"This could cause the app to malfunction. Please contact the app developer."};app.logger?app.logger.error(error):console.error(app,error.message)}overwritesPrototype||(obj=_.omit(obj,conflicts)),$.extend(app,obj)}function parseEventMeta(app,event){var selector,eventMeta={},match=event.match(eventSplitter);return eventMeta.name=match[1].replace(/,/g," "),selector=match[2],match=selector.match(stateRefRegex),match?(app.logger.warn(fmt("In future versions of the framework, events with state flags, such as '%@', will not be supported",match[0])),eventMeta.state=match[1]):eventMeta.selector=selector,eventMeta}function resolveHandler(handler,app){if("function"==typeof handler)return handler;var match=handler.match(stateRefRegex);if(match)return app.logger.warn(fmt("In future versions of the framework, `switchTo` event handlers, such as '%@', will not be supported",match[0])),function(){app.switchTo(match[1])};var fn=get(app,handler);return"function"!=typeof fn?app.logger.error.bind(app.logger,{message:"Event handler `%@` is not a function".fmt(handler)}):fn}function notifyPropertyChange(obj){assert("You need to provide an object to `notifyPropertyChange`",null!=obj),isFunction(obj.notifyPropertyChange)&&obj.notifyPropertyChange.apply(obj,slice.call(arguments,1))}function invokeInApp(app,func){var args=slice.call(arguments,2),prevSetTimeout=window.ZendeskApps.setTimeout,prevSetInterval=window.ZendeskApps.setInterval,isInAppScope="AppScope"===_.result(this,"toString");window.ZendeskApps.setTimeout=function(fn,ms){var args=[app,fn].concat(slice.call(arguments,2)),id=setTimeout(bindWithArgs(this,invokeInApp,args),ms);return app._timeoutIds.push(id),id},window.ZendeskApps.setInterval=function(fn,ms){var args=[app,fn].concat(slice.call(arguments,2)),id=setInterval(bindWithArgs(this,invokeInApp,args),ms);return app._intervalIds.push(id),id};try{return func.apply(isInAppScope?this:app,args)}catch(error){return app.__errorCount++,app.logger.set("app_framework.max_error.app_id",app.id()+"-"+app.__errorCount),app.logger.error(error),error}finally{window.ZendeskApps.setTimeout=prevSetTimeout,window.ZendeskApps.setInterval=prevSetInterval}}function getTime(){return window.performance&&"now"in window.performance?window.performance.now():Date.now()}Object.defineProperty(exports,"__esModule",{value:!0}),exports.fmt=fmt,exports.runLater=runLater,exports.setPath_p=setPath_p,exports.noop=noop,exports.isFunction=isFunction,exports.appendParams=appendParams,exports.flattenArray=flattenArray,exports.flattenObject=flattenObject,exports.assert=assert,exports.extend=extend,exports.inherit=inherit,exports.extendAppAndWarn=extendAppAndWarn,exports.parseEventMeta=parseEventMeta,exports.resolveHandler=resolveHandler,exports.notifyPropertyChange=notifyPropertyChange,exports.invokeInApp=invokeInApp,exports.getTime=getTime;var get,getWithDefault,set,dasherize,underscorize,_=require("underscore"),$=require("jquery"),Ember=window.Ember,stateRefRegex=/^%([a-zA-Z0-9]+)$/,eventSplitter=/^([a-zA-Z(\*\.)](?:[a-zA-Z0-9\._,\-]+))\s*(.*)$/;if(Ember)exports.get=get=Ember.get,exports.set=set=Ember.set,exports.getWithDefault=getWithDefault=Ember.getWithDefault,exports.dasherize=dasherize=Ember.String.dasherize,exports.underscorize=underscorize=Ember.String.underscore;else{exports.get=get=function(obj,key){return assert("You need to provide an object to `get`.",null!=obj),assert("You need to provide a key to `get`.",null!=key),isPath(key)?getPath(obj,key):obj[key]},exports.getWithDefault=getWithDefault=function(obj,key,defaultValue){var val=get(obj,key);return void 0===val?defaultValue:val},exports.set=set=function(obj,key,val){return assert("You need to provide an object to `set`.",null!=obj),assert("You need to provide a key to `set`.",null!=key),isPath(key)?setPathHelper(obj,key,val,function(obj,key){assert(fmt("Object in path %@ could not be found.",key),!!obj)}):obj[key]=val,val};var STRING_DASHERIZE_REGEXP=/[ _]/g;exports.dasherize=dasherize=function(string){return string.replace(STRING_DASHERIZE_REGEXP,"-")};var STRING_UNDERSCORE_REGEXP_1=/([a-z\d])([A-Z]+)/g,STRING_UNDERSCORE_REGEXP_2=/\-|\s+/g;exports.underscorize=underscorize=function(str){return str.replace(STRING_UNDERSCORE_REGEXP_1,"$1_$2").replace(STRING_UNDERSCORE_REGEXP_2,"_").toLowerCase()}}exports.get=get,exports.getWithDefault=getWithDefault,exports.set=set,exports.dasherize=dasherize,exports.underscorize=underscorize;{var slice=exports.slice=Array.prototype.slice;exports.forEach=Array.prototype.forEach}},"closet.js":function(module){"use strict";var QUOTA_EXCEEDED_ERROR=22,isSecurityError=function(name){return"SECURITY_ERR"===name||"SecurityError"===name},Closet=function Closet(useNativeCloset){return useNativeCloset||!Closet.hasLocalStorage()?new Closet.NativeStore:new Closet.LocalStore};Closet.hasLocalStorage=function(){var storage,result;try{return storage=window.localStorage,null==storage?!1:(storage.setItem("__hasLocalStorage__","true"),result="true"===storage.getItem("__hasLocalStorage__"),storage.removeItem("hasLocalStorage"),result)}catch(e){if(e.code===QUOTA_EXCEEDED_ERROR||isSecurityError(e.name))return!1;throw e}};var storage,updateLength,findKeys=function(storage,regex){var keys=[];regex=new RegExp(regex);for(var key in storage)if(storage.hasOwnProperty(key)){if(regex&&!regex.test(key))continue;keys.push(key)}return keys};Closet.NativeStore=function(){storage={},updateLength=function(){var count=0;for(var key in storage)storage.hasOwnProperty(key)&&(count+=1);this.length=count}},Closet.NativeStore.prototype={length:0,getItem:function(name){return"undefined"==typeof storage[name]?null:storage[name]},setItem:function(name,value){storage[name]=value,updateLength.call(this)},removeItem:function(name){delete storage[name],updateLength.call(this)},clear:function(){storage={},updateLength.call(this)},keys:function(regex){return findKeys(storage,regex)},storageType:function(){return"Native"}},Closet.LocalStore=function(){updateLength=function(){this.length=window.localStorage.length}},Closet.LocalStore.prototype={length:0,getItem:function(name){try{return JSON.parse(window.localStorage.getItem(name))}catch(e){return null}},setItem:function(name,value){var result=window.localStorage.setItem(name,JSON.stringify(value));return updateLength.call(this),result},removeItem:function(name){var result=window.localStorage.removeItem(name);return updateLength.call(this),result},clear:function(){var result=window.localStorage.clear();return updateLength.call(this),result},keys:function(regex){return findKeys(window.localStorage,regex)},storageType:function(){return"LocalStorage"}},module.exports=Closet},"log/app.js":function(module,exports,require){"use strict";var _utils=require("utils"),Logger=require("log/base"),I18n=require("i18n"),AppLogger=function(runningApp){var appTitle=_utils.dasherize(runningApp.installation.settings.title),installId=runningApp.installation.installation.id;Logger.call(this,_utils.fmt("%@/installation-%@",appTitle,installId)),this.errorMessages=[],this.runningApp=runningApp,this.app=runningApp.app};_utils.extend(AppLogger.prototype,Logger,{deprecate:function(message,test){this.app.deprecated()&&this.warn(message,test)},warn:function(message,test){(void 0===test||test)&&console.warn(this._appTitle(),message)},error:function(_error){var hasErrors=this.hasErrors(),message=_error.stack||_error.message;this.errorMessages.push(_error.message),this._super(message),console.error(this._appTitle(),message),this.app.host&&(hasErrors?this._appendLatestErrors():this._appendNewError(_error.message))},hasErrors:function(){return this.errorMessages.length>0},latestErrors:function(howMany){return howMany=howMany||5,this.errorMessages.slice(0,howMany)},_appTitle:function(){return _utils.fmt('[App "%@"]',this.runningApp.installation.settings.title)},_appendNewError:function(message){this.app.host.callWhenEventsReady(this.app,function(){var $headers=this.app.$().find("header"),selector=$headers.length?$headers.first():this.app.$(),title=I18n.t("txt.apps.error.javascript_exception");selector.prepend('<span id="test" class="badge badge-warning app-warning-icon"><i class="icon-warning-sign"></i></span>'),selector.find(".app-warning-icon").popover({content:message,placement:"left",title:title,html:!0,trigger:"hover"})}.bind(this))},_appendLatestErrors:function(){var iconWarning=this.app.$().find(".app-warning-icon"),latestErrors=this.latestErrors();iconWarning.attr("data-content",latestErrors.join("<br/>"))},clear:function(){this.errorMessages.length=0}}),Logger.METRIC_TYPES.forEach(function(name){AppLogger.prototype[name]=function(key,val,tags){var installation=this.runningApp.installation.installation;Logger.prototype[name].call(this,key,val,["app_id:"+installation.app_id,"app_name:"+installation.app_name].concat(tags||[]))}}),module.exports=AppLogger},"request.js":function(module,exports,require){"use strict";function headerify(key){return"claims"===key?"-CLAIM":"-"+key.replace(/_/g,"-").toUpperCase()}function setJWTHeaders(jwtOptions,jqXHR,prefix){for(var key in jwtOptions)jwtOptions.hasOwnProperty(key)&&(prefix=prefix||JWT_PREFIX,_.isObject(jwtOptions[key])?setJWTHeaders(jwtOptions[key],jqXHR,prefix+headerify(key)):jqXHR.setRequestHeader(prefix+headerify(key),jwtOptions[key].toString()))}function retryAfter(response){var retryAfterDelay=response.getResponseHeader("retry-after");return(response.status===TOO_MANY_REQUESTS||response.status===SERVICE_UNAVAILABLE)&&parseInt(retryAfterDelay,10)}var _utils=require("utils"),$=require("jquery"),_=require("underscore"),RequestManager=require("./requests/request_manager.js"),ZAT=require("zat"),JWT_PREFIX="X-PROXY-JWT",TOO_MANY_REQUESTS=429,SERVICE_UNAVAILABLE=503,Request=function(name,options,app){this.name=name,this.options=options,this.app=app,this._pendingRequests=[],this._pendingRetries=[],app.logger.warn(_utils.fmt("Using `proxy_v2` in request '%@' is deprecated. From App Framework version 1.0, `proxy_v2` is the default for all requests and can be removed when using App Framework version 1.0 or higher.",[name]),void 0!==options.proxy_v2)};Request.prototype={_triggerEvent:function(kind,args){this.app.trigger(_utils.fmt("%@.%@",this.name,kind),{responseArgs:_utils.slice.call(args)})},perform:function(){var options=this.options;return $.isFunction(options)&&(options=options.apply(this.app,arguments)),this._handleAjax(options)},abortPending:function(){for(;this._pendingRequests.length;)this._pendingRequests.shift().abort();for(;this._pendingRetries.length;)clearTimeout(this._pendingRetries.shift())},_addCallbacks:function(ajax,dfd,options,isLocal){var self=this,retryDelay=0;this._pendingRequests.push(ajax),ajax.done(function(){self._triggerEvent("done",arguments),_utils.invokeInApp(self.app,dfd.resolveWith.bind(dfd,self.app,arguments))}).fail(function(response){retryDelay=isLocal!==!1&&retryAfter(response),retryDelay?self._retryAjax(options,retryDelay):(self._triggerEvent("fail",arguments),_utils.invokeInApp(self.app,dfd.rejectWith.bind(dfd,self.app,arguments)))}).always(function(){if(!retryDelay){self._triggerEvent("always",arguments);var index=self._pendingRequests.indexOf(ajax);self._pendingRequests.splice(index,1)}})},_retryAjax:function(options,seconds){this.app.logger.warn(_utils.fmt("Request '%@' was rate-limited, retrying in %@ seconds.",this.name,seconds)),this._triggerEvent("delayed",[{delay:seconds}]);var pendingRetryId=setTimeout(function(){var index=this._pendingRetries.indexOf(pendingRetryId);-1!==index&&this._pendingRetries.splice(index,1),this._handleAjax(options)}.bind(this),1e3*seconds);this._pendingRetries.push(pendingRetryId)},_addCustomHeaders:function(options){var installationId=_utils.get(this,"app.installation.installation.id"),appId=_utils.get(this,"app.installation.installation.app_id"),jwt=_utils.get(options,"jwt"),defaultBeforeSend=$.ajaxSettings.beforeSend,customBeforeSend=options.beforeSend;options.beforeSend=function(jqXHR,settings){[defaultBeforeSend,customBeforeSend].forEach(function(beforeSend){$.isFunction(beforeSend)&&beforeSend(jqXHR,settings)}),jqXHR.setRequestHeader("X-Zendesk-App-Installation-Id",installationId),jqXHR.setRequestHeader("X-Zendesk-App-Id",appId),_.isObject(jwt)&&setJWTHeaders(jwt,jqXHR)}},_handleAjax:function(options){var result=$.Deferred();return _utils.runLater(this,function(){var request,isLocal;options.context=options.context||this.app,options.url=options.url&&options.url.trim()||"",request=RequestManager.makeRequest(this,options),this._addCallbacks(request,result,options,isLocal)}),result.promise()},_pageHref:function(){return window.location.href},_pageHost:function(){return window.location.host},_pageProtocol:function(){return window.location.protocol},_urlIsLocal:function(url){var local,remote;return local=document.createElement("a"),remote=document.createElement("a"),local.href=this._pageHref(),remote.href=url,remote.href=remote.href,ZAT.isEnabled()&&"localhost"===remote.hostname?!0:local.protocol===remote.protocol&&local.hostname===remote.hostname&&local.port===remote.port}},module.exports=Request},"storage.js":function(module,exports,require){"use strict";function DataStore(id){this.id=id,this.closet=new Closet,this.hasExpired()&&this.clear()}var _utils=require("utils"),Closet=require("closet"),_=require("underscore"),NAMESPACE_TPL="install-%@.%@",EXPIRES_IN_DAYS=30,fmtKey=function(id,key,privateKey){return privateKey?_utils.fmt(NAMESPACE_TPL,[id+"-private",key]):_utils.fmt(NAMESPACE_TPL,[id,key])},getItem=function(key){return this.closet.getItem(key)},setItem=function(key,value){this.closet.setItem(key,value),this.closet.setItem(fmtKey(this.id,"timestamp",!0),new Date)};DataStore.prototype.store=function(key,value){var fmttedKey=fmtKey(this.id,key);return _.isString(key)&&1===arguments.length?getItem.call(this,fmttedKey):void(_.isObject(key)&&1===arguments.length?_.each(key,function(val,k){key.hasOwnProperty(k)&&this.store(k,val)},this):setItem.call(this,fmttedKey,value))},DataStore.prototype.hasExpired=function(){var timestampKey=fmtKey(this.id,"timestamp",!0),expiryDate=new Date(this.closet.getItem(timestampKey)),now=new Date;return expiryDate.setDate(expiryDate.getDate()+EXPIRES_IN_DAYS),now>expiryDate&&"LocalStorage"===this.closet.storageType()},DataStore.prototype.clear=function(){var regex=new RegExp("install-"+this.id),installStore=this.closet.keys(regex);_.each(installStore,function(key){this.closet.removeItem(key)},this)},module.exports=DataStore},"helpers.js":function(module,exports,require){"use strict";var _utils=require("utils"),unboundSlice=require("utils").slice,slice=Function.prototype.call.bind(unboundSlice);module.exports={fmt:function(str){return _utils.fmt.call(null,str,slice(arguments,1))},safeString:function(str){return new Handlebars.SafeString(str)}}},"version.js":function(module,exports,require){"use strict";function isFrameworkVersionDeprecated(versionNumber){var version=parseFloat(versionNumber);return DEPRECATE_BEFORE>version}function FrameworkVersion(versionNumber,directory){$.extend(this,directory,{deprecated:isFrameworkVersionDeprecated(versionNumber),versionNumber:versionNumber}),allVersions[versionNumber]=this}var _utils=require("utils"),$=require("jquery"),allVersions={},DEPRECATE_BEFORE=1;FrameworkVersion.prototype.toString=function(){return _utils.fmt("Apps Framework Version %@",this.versionNumber)},FrameworkVersion.find=function(versionNumber){return allVersions[versionNumber]},new FrameworkVersion("2.0",{Request:require("request")}),new FrameworkVersion("1.0",{Request:require("request")}),new FrameworkVersion("0.5",{Request:require("0_5/request")}),module.exports=FrameworkVersion},"reloader.js":function(module,exports,require){"use strict";var $=require("jquery"),InstalledApp=require("installed_app"),queue=$.Callbacks("unique"),isReloading=!1,Reloader={getLocalAppUrl:function(){return $("script[data-zat-enabled]").prop("src")||"/api/v2/apps/installed.js"},reload:function(callback){callback&&queue.add(callback),isReloading||(isReloading=!0,$.ajax({url:Reloader.getLocalAppUrl(),dataType:"text"}).done(function(data){InstalledApp.clear(),$.globalEval(data),queue.fire.call(queue)}).always(function(){queue.empty(),isReloading=!1}))}};module.exports=Reloader},"app/base.js":function(module,exports,require){"use strict";function isEventFromIframe(eventName){return/^iframe\.\w+$/.test(eventName)}function mixinDataToEvent(evt,data,logger){var warned=!1;_.isObject(data)&&Object.keys(data).forEach(function(key){"type"!=key&&(Object.defineProperty(evt,key,{configurable:!0,enumerable:!0,get:function(){if(!warned){var err=new Error("Direct property access from the jQuery event will be deprecated soon.Please change your app to access the raw data as the second argument.See https://developer.zendesk.com/apps/docs/agent/public_changelog for more info");logger.warn(err),warned=!0}return evt["_"+key]},set:function(val){warned=!0,Object.defineProperty(evt,"_"+key,{configurable:!0,enumerable:!1,value:val})}}),evt[key]=data[key])})}function BaseApp(){this._registeredIframe=!1,this._processedEvents={},this.__errorCount=0}var _=require("underscore"),$=require("jquery"),FrameworkVersion=require("version"),InstalledApp=require("installed_app");_.extend(BaseApp.prototype,{trigger:function(eventName,data){var app=this,event=$.Event(eventName+".appview"),callback=function(view){var $view=view.$();$view&&$view.trigger(event,[data]),app._registeredIframe&&!isEventFromIframe(eventName)&&app.postMessage(eventName,data)};mixinDataToEvent(event,data,app.logger),this.host?this.host.callWhenEventsReady(this,callback):_.defer(callback.bind(this),this.$domEl.get(0))},setting:function(name){return"name"===name&&(name="title"),this.settings[name]},requirement:function(identifier){return this.installation.requirements[identifier]},framework:function(){return FrameworkVersion.find(this.frameworkVersion)},deprecated:function(){return this.framework().deprecated},installationId:function(){return this.installation.installation.id},id:function(){return this.installation.installation.app_id},name:function(){return this.installation.installation.app_name},version:function(){return this.appVersion},assetURL:function(name){return this.assetUrlPrefix+name},_isNoTemplate:function(){return!0===this.constructor.noTemplate||_.isEmpty(this.templates)},_isSingleInstall:function(){return!0===this.constructor.singleInstall},_isNoTemplateForLocation:function(location){var noTemplateLocations=this.installation.appClass.noTemplate;return this._isNoTemplate()||noTemplateLocations&&_.contains(noTemplateLocations,location)||!1},useSystemChrome:function(){return!1}}),BaseApp.install=function(installation){InstalledApp.push(this,installation)},BaseApp.extend=function(subclassProperties){function AppSubclass(settings){ParentClass.call(this,settings)}var ParentClass=this;return AppSubclass.reopen=function(properties){return $.extend(this.prototype,properties),this},AppSubclass.reopenClass=function(properties){return $.extend(this,properties),this},AppSubclass.reopen(new ParentClass(subclassProperties)),AppSubclass.reopenClass(this),AppSubclass},module.exports=BaseApp},"log/base.js":function(module,exports,require){"use strict";var _utils=require("utils"),_=require("underscore"),Minilog=require("minilog"),ZendeskReporter=require("reporter"),timeCache={};window.console||(window.console={log:_utils.noop,info:_utils.noop,debug:_utils.noop,warn:_utils.noop,error:_utils.noop,timeStamp:_utils.noop});var tryConsole=function(name){return console[name]&&console[name].apply(console,_utils.slice.call(arguments,1))},Logger=function(scope){var loggerName="apps";scope&&(loggerName+="/"+scope),this.minilog=Minilog&&Minilog(loggerName)||console,this.reporter=ZendeskReporter&&new ZendeskReporter};Logger.METRIC_TYPES=["set","increment","gauge","histogram","timing"],Logger.prototype.deprecate=_utils.noop,Logger.prototype.willLog=_utils.noop,["debug","info","warn","error"].forEach(function(name){Logger.prototype[name]=function(){var args=_utils.slice.call(arguments);return this.willLog&&this.willLog(args),this.minilog[name].apply(this.minilog,args)}}),Logger.prototype.log=Logger.prototype.info,Logger.prototype.time=function(label){timeCache[label]=_utils.getTime()},Logger.prototype.timeEnd=function(label){var start=timeCache[label];"number"==typeof start&&this.info(_utils.fmt("%@: %@ (ms)",label,_utils.getTime()-start))},Logger.prototype.timeStamp=function(){var ts=console.timeStamp;return ts?ts.bind(console):_utils.noop}(),["group","groupEnd","groupCollapsed"].forEach(function(name){Logger.prototype[name]=function(label){return this.info(_utils.fmt("%@:%@",name,label)),tryConsole(name,label)}}),Logger.prototype.benchmark=function(name,fn){var start,result,args=_utils.slice.call(arguments,2);return start=_utils.getTime(),this.timeStamp(name),result=fn.apply(null,args),this.info(name,_utils.fmt("%@ (ms)",_utils.getTime()-start)),result},Logger.METRIC_TYPES.forEach(function(name){Logger.prototype[name]=function(){this.reporter&&_.isFunction(this.reporter[name])&&this.reporter[name].apply(this.reporter,arguments)}}),Logger.logger=Object.freeze(new Logger),module.exports=Logger},"app_i18n.js":function(module,exports,require){"use strict";function AppI18n(app){this.app=app}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol?"symbol":typeof obj},_utils=require("utils"),$=require("jquery"),Handlebars=require("handlebars");$.extend(AppI18n.prototype,{t:function(key,context){var keyType="undefined"==typeof key?"undefined":_typeof(key);return _utils.assert(_utils.fmt("Translation key must be a string, got: %@",keyType),"string"===keyType),this._template(key)(context)},_template:function(key){var templatePath=_utils.fmt("app.translations.%@",key),template=_utils.get(this,templatePath);if(null==template&&(template=_utils.fmt("Missing translation: %@",key)),!$.isFunction(template)){if("string"!=typeof template)return void(this.app.logger&&this.app.logger.error({message:"Invalid translation for key: "+key}));template=Handlebars.compile(template),_utils.set(this,templatePath,template)}return template}}),module.exports=AppI18n},"app_scope.js":function(module,exports,require){"use strict";function AppScope(){this.require=function(){try{return _utils.assert("No modules have been defined for this app",null!=this.require.modules),CommonJS.require.apply(this,arguments)}catch(e){return logger.error(e),null}}.bind(this),this.require.cache={},["window","top","self","frames","parent"].forEach(function(key){this[key]=this},this),this._=patchedUnderscore(this)}var _utils=require("utils"),_=require("underscore"),patchedUnderscore=require("patched_underscore"),DocumentWrapper=require("wrappers/document_wrapper"),CommonJS=require("common_js"),Logger=require("log/base"),logger=new Logger("app-scope");_.extend(window.ZendeskApps,{setTimeout:function(){return console.warn("Unexpected invocation of setTimeout by an app."),window.setTimeout.apply(window,arguments)},setInterval:function(){return console.warn("Unexpected invocation of setInterval by an app."),window.setInterval.apply(window,arguments)}}),AppScope.prototype={setTimeout:function(){return window.ZendeskApps.setTimeout.apply(this,arguments)},setInterval:function(){return window.ZendeskApps.setInterval.apply(this,arguments)},document:Object.freeze(DocumentWrapper(document)),helpers:Object.freeze(require("helpers")),services:require("core_services").publicApi(),TicketField:Object.freeze(require("wrappers/ticket_field")),TicketType:Object.freeze(require("wrappers/ticket_type")),TicketPriority:Object.freeze(require("wrappers/ticket_priority")),TicketStatus:Object.freeze(require("wrappers/ticket_status")),TicketPostSaveAction:Object.freeze(require("wrappers/ticket_post_save_action")),toString:function(){return"AppScope"}},["undefined","jQuery","$","Ember","Em","Zendesk","Zd"].forEach(function(key){AppScope.prototype[key]=void 0}),module.exports=Object.freeze({create:function(){return Object.seal(new AppScope)}})},"common_js.js":function(module,exports){"use strict";function _require(name,root){var module,fn,path=expand(root,name),indexPath=expand(path,"./index.js");if(/\.js$/.test(path)||(path+=".js"),module=this.require.cache[path]||this.require.cache[indexPath])return module;if((fn=this.require.modules[path])||(fn=this.require.modules[path=indexPath]))return module={id:path,exports:{}},this.require.cache[path]=module.exports,fn(module.exports,function(name){return this.require(name,dirname(path))}.bind(this),module),this.require.cache[path]=module.exports,this.require.cache[path];throw"module "+name+" not found"}Object.defineProperty(exports,"__esModule",{value:!0});var dirname=function(path){return path.split("/").slice(0,-1).join("/")},expand=function(root,name){var parts,part,results=[];parts=/^\.\.?(\/|$)/.test(name)?[root,name].join("/").split("/"):name.split("/");for(var i=0,length=parts.length;length>i;i++)part=parts[i],".."==part?results.pop():"."!==part&&""!==part&&results.push(part);return results.join("/")};exports.require=_require},"helpers/t.js":function(module,exports,require){"use strict";var AppHelpers=require("app_helpers");module.exports=function(){return function(key,options){return AppHelpers.currentApp.I18n.t(key,options.hash)}}},"api_router.js":function(module,exports,require){"use strict";function APIUnavailableError(message){this.name="APIUnavailable",
this.message=message||"API unavailable",this.stack=(new Error).stack}function successOnlyPromise(promise){var dfd=$.Deferred();return promise.then(dfd.resolve.bind(dfd),dfd.resolve.bind(dfd)),dfd.promise()}function apiUnavailableErrorPromise(msg){return $.Deferred().reject(new APIUnavailableError(msg)).promise()}function getOrSet(handlers,app,paths,setterObj){var responseData={},promises=paths.map(function(path){var handlerPromise=$.when(),success=handlers.some(function(handler){var handlerArgs=[app,path];setterObj&&handlerArgs.push(setterObj[path]);var handlerResponse=handler.apply(null,handlerArgs);return handlerResponse&&_.isFunction(handlerResponse.then)?(handlerResponse=handlerResponse.then(function(response){responseData[path]=response},function(err){app.logger.warn(err)}),handlerPromise=successOnlyPromise(handlerResponse),!0):!1});return success||app.logger.warn(_utils.fmt("Could not find handler for %@",path)),handlerPromise});return $.when.apply($,promises).then(function(){return responseData})}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol?"symbol":typeof obj},_utils=require("utils"),_=require("underscore"),$=require("jquery");APIUnavailableError.prototype=Object.create(Error.prototype),APIUnavailableError.prototype.constructor=APIUnavailableError;var methodHandlers={get:function(handlers,app,params){return params=Array.isArray(params[0])?params[0]:params,getOrSet(handlers,app,params)},set:function(handlers,app,params){var setterObj=Array.isArray(params)?params[0]:params,paths=Object.keys(setterObj);return getOrSet(handlers,app,paths,setterObj)},invoke:function(handlers,app,params){var path;"object"!==("undefined"==typeof params?"undefined":_typeof(params))||Array.isArray(params)?path=params.shift():(path=Object.keys(params)[0],params=params[path]);var handlerResponse,success=handlers.some(function(handler){return handlerResponse=handler.call(null,app,path,params),handlerResponse&&_.isFunction(handlerResponse.then)?!0:!1});return success?handlerResponse.then(function(result){var obj={};return obj[path]=result,obj},function(err){return apiUnavailableErrorPromise(err.message)}):apiUnavailableErrorPromise(_utils.fmt("API Unavailable: %@",path))}},ApiRouter=function(){this.handlerMap={}};ApiRouter.prototype={registerHandler:function(method,handler){if(!methodHandlers[method])throw new Error(_utils.fmt("Unhandled method: %@",method));this.handlerMap[method]=this.handlerMap[method]||[],this.handlerMap[method].push(handler)},handleRequest:function(app,method,arrOrObj){var handlers=this.handlerMap[method]||[];return methodHandlers[method](handlers,app,arrOrObj)}},ApiRouter.APIUnavailableError=APIUnavailableError,module.exports=ApiRouter},"events/dom.js":function(module,exports,require){"use strict";function replacePlaceholders(app,descriptor){var customFieldPlaceholderMatch=descriptor.match(customFieldRegex);return customFieldPlaceholderMatch&&app.settings[customFieldPlaceholderMatch[2]]?descriptor.replace(customFieldPlaceholderMatch[1],app.settings[customFieldPlaceholderMatch[2]]):descriptor}function DOMEvent(app,descriptor){var eventDescriptor=replacePlaceholders(app,descriptor);this.eventMeta=_utils.parseEventMeta(app,eventDescriptor),ViewEvent.call(this,app,this.eventMeta.name)}var _utils=require("utils"),ViewEvent=require("events/view"),customFieldRegex=/custom_field_(\{\{(.+)\}\})/;DOMEvent.prototype=Object.create(ViewEvent.prototype),DOMEvent.prototype.bind=function(handler,view){var selector=this.eventMeta.selector;(""===selector||view.$().is(selector)&&!view.$(selector).length)&&(selector=void 0),ViewEvent.prototype.bind.call(this,handler,view,selector)},module.exports=DOMEvent},"app/iframe.js":function(module,exports,require){"use strict";function IframeApp(){BaseApp.apply(this,arguments)}var _utils=require("utils"),$=require("jquery"),_=require("underscore"),BaseApp=require("app/base"),ASSET_URI_REGEX=/^assets\/(.+)$/;_utils.inherit(IframeApp,BaseApp),$.extend(IframeApp.prototype,{renderTemplate:function(name){if("layout"===name){var locationUrlMatcher,host=this.currentHost(),location=this.currentLocation(),appClass=this.installation.appClass,origin=window.location.protocol+"//"+window.location.host,params=_utils.fmt("origin=%@&app_guid=%@",encodeURIComponent(origin),this.__guid),locationUrl=_utils.appendParams(appClass.location[host][location],params);return(locationUrlMatcher=ASSET_URI_REGEX.exec(locationUrl))?locationUrl=this.assetURL(locationUrlMatcher[1]):appClass.signedUrls&&(locationUrl=_utils.fmt("/apps/installations/%@/iframe_redirect?location=%@&%@",this.installationId(),location,params)),$("<iframe></iframe>").prop("src",locationUrl).css({width:"100%"}).prop("sandbox","allow-forms allow-popups allow-popups-to-escape-sandbox allow-scripts allow-same-origin").prop("outerHTML")}},_isNoTemplate:function(){return!1},resize:function(size){var $iframe=this.$("iframe");return $iframe.css(_.pick(size,"height","width")),{width:$iframe.width(),height:$iframe.height()}},useSystemChrome:function(){return!0}}),IframeApp.install=BaseApp.install,IframeApp.extend=BaseApp.extend.bind(IframeApp),module.exports=IframeApp},"app/legacy.js":function(module,exports,require){"use strict";function ArgumentError(){var msg,types=[];arguments.length&&(_utils.forEach.call(arguments,function(klass){types.push("undefined"==typeof klass?"undefined":_typeof(klass))}),msg=_utils.fmt("%@: Argument(s) should be of type: [ %@ ]",this.name,types),Error.call(this,msg),this.message=msg)}function withCleanHandlebars(func,context,args){var originalHelpers=Handlebars.helpers;Handlebars.helpers=AppHelpers,AppHelpers.currentApp=context;var result=func.apply(context,args);return Handlebars.helpers=originalHelpers,result}function processRequests(app,requests){var Request=app.framework().Request,processedRequests={};return Object.keys(requests).forEach(function(name){processedRequests[name]=new Request(name,requests[name],app)}),processedRequests}function requestFor(app,requestName){null==app.processedRequests&&(app.processedRequests=processRequests(app,app.requests));var request=app.processedRequests[requestName];return _utils.assert(_utils.fmt("No such request: %@",requestName),null!=request),request}function addDeferred(app,dfd){var removeDeferred=function(){var index=app._appPromises.indexOf(dfd);index>-1&&(app._appPromises[index]=null)};dfd.always(removeDeferred),app._appPromises.push(dfd)}function inDOM(app){return!!app.$().length}function LegacyApp(properties){BaseApp.apply(this,arguments),_utils.extendAppAndWarn(this,properties,!0),this._processedEvents={},this.adapters=[zdMenuAdapter,dateAdapter,timeAdapter],this.I18n=new AppI18n(this),this._appPromises=[],this._timeoutIds=[],this._intervalIds=[]}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol?"symbol":typeof obj},_utils=require("utils"),$=require("jquery"),_=require("underscore"),Handlebars=require("handlebars"),Site=require("site"),ZAT=require("zat"),AppI18n=require("app_i18n"),AppHelpers=require("app_helpers"),BaseApp=require("app/base"),AppRuntime=require("app_runtime"),zdMenuAdapter=require("lib/views/adapters/zd_menu"),dateAdapter=require("lib/views/adapters/zd_date"),timeAdapter=require("lib/views/adapters/zd_time"),VALID_SITES=_.values(Site);$.extend(ArgumentError.prototype,Error,{constructor:ArgumentError,message:"Incorrect arguments provided",name:"ArgumentError"}),_utils.inherit(LegacyApp,BaseApp),$.extend(LegacyApp.prototype,{guid:function(){return this.__guid},template:function template(name){_utils.assert('Trying to access a template for a "No template" App',!this._isNoTemplate());var template=this.templates[name];return _utils.assert("No such template: "+name,null!=template),$.isFunction(template)||(template=Handlebars.compile(template),this.templates[name]=template),template},store:function(){var dataStore=this.installation.dataStore;return dataStore.store.apply(dataStore,arguments)},isZatEnabled:function(){return ZAT.isEnabled()},ajax:function(name){var request=requestFor(this,name);return request.perform.apply(request,_utils.slice.call(arguments,1))},promise:function(fn){if(this.logger.set("app_framework.promise.app_id",this.id()),"function"!=typeof fn)throw new ArgumentError(Function);var dfd=$.Deferred();return addDeferred(this,dfd),_utils.runLater(this,_utils.invokeInApp.bind(null,this,fn),dfd.resolve.bind(dfd),dfd.reject.bind(dfd)),dfd.promise()},when:function(){return $.when.apply($,arguments)},message:function(eventName,data,sites){this.logger.set("app_framework.message.app_id",this.id());var apps,app,site,i,j,runtime=AppRuntime.findRuntimeForApp(this),hostApp=runtime.hostApp;for("string"==typeof sites&&(sites=$.makeArray(sites)),sites||(sites=this.installation.sitesFor(hostApp)),i=0;i<sites.length;i++)for(site=sites[i],_utils.assert(_utils.fmt("%@ is an invalid location.",site),-1!==VALID_SITES.indexOf(site)),apps=this.installation.appsForSite(site),j=0;j<apps.length;j++)app=apps[j],app!==this&&app.trigger.call(app,"message."+eventName,data)},postMessage:function(){throw new Error("postMessage is not available until the app.registered event has fired.")},renderTemplate:function(name,data){var outerHTML,context=this._renderContext(data||{}),template=this.template(name),html=withCleanHandlebars(template,this,[context]);if("layout"===name){var sanitizedHtml="";$(html).each(function(){outerHTML=$(this).prop("outerHTML"),outerHTML&&(sanitizedHtml+=outerHTML)}),html=sanitizedHtml}return html},renderCurrentState:function(){if(this.currentState){var html=this.renderTemplate(this.currentState,this.currentData);this.$main().html(html),this.applyViewAdapters()}},applyViewAdapters:function(){var $view=this.$main();0!==this.adapters.length&&this.adapters.forEach(function(adapter){adapter($view)})},switchTo:function(state,data){this.currentState=state,this.currentData=data||{},inDOM(this)&&this.logger.benchmark("switchTo",this.renderCurrentState.bind(this))},$main:function(){var mainElem=this.$("[data-main]");return _utils.assert("No DOM element marked as `main` (use a `data-main` attribute to indicate)",mainElem.length),mainElem},_renderContext:function(data){return $.extend({},{I18n:this.translations},this.containerContext(),{author:this.author},data)}}),LegacyApp.install=BaseApp.install,LegacyApp.extend=BaseApp.extend.bind(LegacyApp),module.exports=LegacyApp},"0_5/request.js":function(module,exports,require){"use strict";function Request_v0_5(name,options,app){Request.call(this,name,options,app)}var _utils=require("utils"),$=require("jquery"),Request=require("request");_utils.inherit(Request_v0_5,Request),Request_v0_5.prototype._mungeOptionsForProxy=function(options){var result=$.extend({},options),originalUrl=options.url;if(options.proxy_v2){result._metricType="pass-through-proxy";var divider,isGet=void 0===options.type||"GET"===options.type;isGet&&options.data&&(divider=originalUrl.indexOf("?")>0?"&":"?",originalUrl+=divider+decodeURIComponent($.param(options.data)),delete result.data),result.url=_utils.fmt("/proxy/to/%@",encodeURIComponent(originalUrl))}else{result._metricType="0-5-proxy";var isPost="POST"===options.type||"PUT"===options.type,dataType=options.dataType,destinationUrl="/proxy/direct?url=%@&timeout=10";null!=dataType&&"json"===dataType.toLowerCase()?(isPost&&(result.data=_utils.fmt("body=%@",encodeURIComponent(JSON.stringify(options.data))),result.processData=!1),destinationUrl+="&contenttype=application/json"):isPost&&null!=dataType&&"xml"===dataType.toLowerCase()&&(result.data=_utils.fmt("body=%@",encodeURIComponent(options.data)),result.processData=!1),result.url=destinationUrl.fmt(encodeURIComponent(originalUrl))}return result},module.exports=Request_v0_5},"events/hook.js":function(module,exports,require){"use strict";function HookEvent(app,descriptor){this.app=app,this.descriptor=descriptor,app.logger.set("app_framework.event_hook.app_id",app.id()+"-"+descriptor,["event-descriptor:"+descriptor]),AppRuntime.findRuntimeForApp(app).registerHook(this)}var $=require("jquery"),AppRuntime=require("app_runtime");HookEvent.prototype={bind:function(handler){this.handler=handler},willTrigger:function(type){return this.descriptor==type},run:function(){var app=this.app,result=this.handler();if(result&&"function"==typeof result.then){var promiseWithApp=$.Deferred();return result.then(promiseWithApp.resolve.bind(promiseWithApp),function(message){promiseWithApp.reject({message:message,title:app.setting("title")})}),promiseWithApp}var dfd=$.Deferred(),isFalsy=result===!1||result instanceof Error||"string"==typeof result;return $.when(isFalsy?dfd.reject({message:result,title:app.setting("title")}):dfd.resolve())}},module.exports=HookEvent},"app_runtime.js":function(module,exports,require){"use strict";function containerMethodsFromView(){var containerView=this.containerView;return containerView&&_.isFunction(containerView.containerMethods)?containerView.containerMethods.bind(containerView):void 0}function AppRuntime(options){this.options=options||{},this.containerView=this.options.containerView||this.options.host,this.containerMethods=this.options.containerMethods||containerMethodsFromView.call(this),this.contextCallback=this.options.contextCallback,this.isActive=!1,this.appsLoaded=!1,this.hostApp=this.options.hostApp||"zendesk",this.location=this.options.location,this.apiRouter=new ApiRouter,this._hooks=[],this._runningApps=[],this._apiHandlers=[],this._subscriber=new AppRuntimeSubscriber,globalRuntimes.push(this),this.registerApiHandler("invoke",AppRuntimeApiHandlers.invoke.bind(this)),this.registerApiHandler("get",AppRuntimeApiHandlers.get.bind(this))}var _utils=require("utils"),_=require("underscore"),$=require("jquery"),InstalledApp=require("installed_app"),Reloader=require("reloader"),Logger=require("log/base"),ApiRouter=require("api_router"),AppRuntimeSubscriber=require("app_runtime_subscriber"),AppRuntimeApiHandlers=require("api_handlers/app_runtime"),logger=new Logger("app-runtime"),globalRuntimes=[],globalRunningApps={};AppRuntime._globalRuntimes=globalRuntimes,AppRuntime._registerApp=function(runningApp){globalRunningApps[runningApp.app.__guid]=runningApp},AppRuntime._unregisterApp=function(runningApp){delete globalRunningApps[runningApp.app.__guid]},AppRuntime.findAppByGuid=function(guid){return globalRunningApps[guid]},AppRuntime.findRuntimeForApp=function(app){for(var i=0,l=globalRuntimes.length;l>i;i++){var runtime=globalRuntimes[i];if(_.find(runtime._runningApps,{app:app}))return runtime}},AppRuntime.prototype={length:function(){return _utils.get(this,"_runningApps").length||0},getLocation:function(){return this.location||_utils.get(this.containerView,"site")},appInstallations:function(){return InstalledApp.forSite(this.getLocation(),this.hostApp)},launchApps:function(){logger.benchmark("launchApps",function(){this.appInstallations().forEach(function(installation){var handler=this.installationEnabled.bind(this,installation);this._subscriber.registerEnabled(installation,handler),this._launchApp(installation)},this)}.bind(this))},_launchApp:function(installation){var RunningApp=require("running_app"),runningApp=new RunningApp(installation,this,this.options.appViewClass),handler=this.installationDisabled.bind(this,runningApp);return this._subscriber.registerDisabled(installation,handler),this._runningApps.push(runningApp),logger.benchmark("launchApp",runningApp.launch.bind(runningApp)),runningApp},installationEnabled:function(installation){logger.debug("Launching app due to underlying installation being enabled"),this._launchApp(installation)},installationDisabled:function(runningApp){logger.debug("Exiting runningApp %s due to underlying installation being disabled",runningApp.app.__guid),this.removeApp(runningApp)},backgroundAppsCount:function(){return this.length()-this.visibleAppsCount()},visibleAppsCount:function(){return _utils.get(this,"_runningApps").filter(function(running){return _utils.get(running,"view.isVisible")}).length},find:function(app){return _utils.get(this,"_runningApps").find(function(running){return running.app===app})},notifyApps:function(eventName,data){_utils.get(this,"_runningApps").forEach(function(running){running.app.trigger(eventName,data)})},reloadAllApps:function(callback){var originalActiveState=this.isActive,args=_utils.slice.call(arguments,1);this.removeApps().then(function(){Reloader.reload(function(){originalActiveState&&this.activate(),_.isFunction(callback)&&callback.apply(null,args)}.bind(this))}.bind(this))},removeApps:function(){var deferred=$.Deferred();this.deactivate();var runningApps=_utils.get(this,"_runningApps"),removeAppPromises=runningApps.map(function(runningApp){return this.removeApp(runningApp)},this);return $.when.apply($,removeAppPromises).then(function(){runningApps.splice(0,runningApps.length),this._hooks=[],this.appsLoaded=!1,deferred.resolve()}.bind(this)),deferred.promise()},removeApp:function(runningApp){var deferred=$.Deferred();return _.defer(function(){runningApp.exit(),this.runningApps=_.without(this.runningApps,runningApp),this._hooks=_.reject(this._hooks,function(hook){return hook.app==runningApp.app}),deferred.resolve()}.bind(this)),deferred.promise()},activate:function(){this.isActive||(this.appsLoaded?this.notifyApps("app.activated",{firstLoad:!1}):(this.launchApps(),this.appsLoaded=!0),this.isActive=!0)},deactivate:function(){this.isActive&&this.notifyApps("app.deactivated"),this.isActive=!1},destroy:function(){this.removeApps(),this._subscriber.destroy();var i=globalRuntimes.indexOf(this);-1!==i&&globalRuntimes.splice(i,1)},publicApi:function(runningApp){return $.extend({containerContext:function(){return _utils.flattenObject({location:this.getLocation()})}.bind(this),currentLocation:function(){return this.getLocation()}.bind(this),currentHost:function(){return this.hostApp}.bind(this)},_.isFunction(this.containerMethods)&&this.containerMethods(runningApp))},runHooksFor:function(type){var hooks=this.hooksForType(type);return _.isEmpty(hooks)&&(hooks=this._hooks),$.when.apply($,hooks.map(function(hook){return hook.run()}))},registerHook:function(hook){this._hooks.push(hook)},hooksForType:function(type,app){return type?this._hooks.filter(function(hook){var willTrigger=hook.willTrigger(type);return app?willTrigger&&hook.app===app:willTrigger}):[]},unregisterHook:function(hook){var i=this._hooks.indexOf(hook);-1!==i&&this._hooks.splice(i,1)},registerApiHandler:function(messageOrObject){var router=this.apiRouter;if("string"==typeof messageOrObject)router.registerHandler.apply(router,arguments);else for(var message in messageOrObject)router.registerHandler.call(router,message,messageOrObject[message])}},module.exports=AppRuntime},"events/view.js":function(module){"use strict";function ViewEvent(app,descriptor){this.app=app,this.descriptor=descriptor}ViewEvent.prototype={bind:function(handler,view,selector){var $el=view.$(),eventName=this.descriptor.replace(/\S+\b/g,function(m){return m+".appview"});selector?$el.on(eventName,selector,handler):$el.on(eventName,handler)}},module.exports=ViewEvent},"app_helpers.js":function(module,exports,require){"use strict";function lookupHelper(name){var helper;try{helper=require(_utils.fmt("helpers/%@",_utils.underscorize(name)))()}catch(err){helper=null}return helper}var _utils=require("utils"),$=require("jquery"),Handlebars=require("handlebars"),Logger=require("log/base"),AppHelpers=$.extend({},Handlebars.helpers,{currentApp:null,t:null}),logger=new Logger("app-helpers"),slice=require("utils").slice,helperMissing=AppHelpers.helperMissing;AppHelpers.helperMissing=function(name){var args=slice.call(arguments);return logger.benchmark("helperMissing",function(){var helper=lookupHelper(name);return helper?(AppHelpers[name]=helper,helper.apply(this,args.slice(1))):helperMissing.apply(this,args)}.bind(this))},["assetURL","setting","store"].forEach(function(helperName){AppHelpers[helperName]=function(name){return AppHelpers.currentApp[helperName](name)}}),["spinner","zd_date","zd_time"].forEach(function(name){AppHelpers[name]=lookupHelper(name)}),module.exports=AppHelpers},"running_app.js":function(module,exports,require){"use strict";function bindEvent(app,eventDescriptor,handler,view){var evt=app._processedEvents[eventDescriptor];if(!evt){var evtClass=EventManager.eventFor(eventDescriptor);evt=new evtClass(app,eventDescriptor),app._processedEvents[eventDescriptor]=evt}handler=_utils.resolveHandler(handler,app),evt.bind(_utils.invokeInApp.bind(null,app,handler),view)}function trackCreatedEvent(location,installation,app){app.logger.set("app_framework.created.location",installation.app_id+"-"+location,["location:"+location]),app.logger.set("app_framework.created.app_id",installation.app_id,["framework-version:"+app.frameworkVersion])}function RunningApp(installation,runtime,appViewClass){this.appViewClass=appViewClass||AppView,this.app=new installation.appClass({}),this.app.__guid=UUID.generate(),this.installation=installation,this.runtime=runtime,this.view=null,AppRuntime._registerApp(this)}var _utils=require("utils"),_=require("underscore"),AppRuntime=require("app_runtime"),AppView=require("app_view/base_v2"),AppLogger=require("log/app"),Logger=require("log/base"),EventManager=require("events/event_manager"),InstalledApp=require("installed_app"),Helpers=require("helpers"),$=require("jquery"),UUID=require("vendor/uuid_generator"),SDKClient=require("zaf_sdk_client"),totalAppsBooted=0;RunningApp.prototype={launch:function(){var app=this.app,location=this.runtime.getLocation(),installedApp=this.installation;app.helpers=Helpers,app.installation=installedApp,app.settings=installedApp.settings,app.logger=new AppLogger(this),app.host=this.runtime.containerView,_utils.extendAppAndWarn(app,this.runtime.publicApi(this)),this.runtime.containerView&&_.isFunction(this.runtime.containerView.createViewForApp)?this.view=this.runtime.containerView.createViewForApp(this):this.prepareView(),app.installation.add(this),app.trigger("app.created"),trackCreatedEvent(location,installedApp.installation,app),app.trigger("app.activated",{firstLoad:!0}),totalAppsBooted++,InstalledApp.count()===totalAppsBooted&&Logger.logger.timeEnd("Initialize Apps")},prepareView:function(){var containerView=this.runtime.containerView;this.view=this.createAppView(),this.app.$=this.view.$.bind(this.view),this.app.$domEl=$(this.view),containerView&&containerView.appendView(this.view),this.view.callWhenReady(this.switchToInitialState,this),this.view.callWhenReady(this.bindEvents,this)},createAppView:function(){var appViewClass=this.appViewClass,app=this.app,view=app.logger.benchmark("createAppView",function(){return new appViewClass(this)}.bind(this));return view},bindEvents:function(target){var key,app=_utils.get(this,"app"),events=_utils.get(app,"events")||{};for(key in events)events.hasOwnProperty(key)&&(app.logger.deprecate("In future versions of the framework, `app.activated` will no longer receive a `firstLoad` flag. Please use `app.created` instead. You can view the documentation at https://developer.zendesk.com/apps/docs/agent/events#framework-events","app.activated"===key),"ticket.description.changed"===key&&app.logger.warn("`ticket.description` has been replaced by `comment.text`, please update your app to use the new event."),bindEvent(app,key,events[key],target))},switchToInitialState:function(){var app=this.app;app.currentState?_utils.invokeInApp(app,app.renderCurrentState.bind(app)):app.defaultState&&_utils.invokeInApp(app,app.switchTo.bind(app,app.defaultState))},destroyEvents:function(){var processedEvents=this.app._processedEvents;for(var key in processedEvents)processedEvents[key].unbind();this.app._processedEvents={}},abortRequests:function(){var processedRequests=this.app.processedRequests;processedRequests&&Object.keys(processedRequests).forEach(function(name){processedRequests[name].abortPending(),delete processedRequests[name]})},rejectPromises:function(){_.chain(this.app._appPromises).compact().invoke("reject")},clearTimers:function(){for(;!_.isEmpty(this.app._timeoutIds);)clearTimeout(this.app._timeoutIds.pop());for(;!_.isEmpty(this.app._intervalIds);)clearInterval(this.app._intervalIds.pop())},exit:function(){if(this.view){this.app.trigger("app.willDestroy"),this.clearTimers(),this.app.installation.remove(this),this.app.logger.clear(),this.abortRequests(),this.rejectPromises(),this.destroyEvents(),SDKClient.deregister(this.app.__guid);var target=_utils.get(this.view,"target");target&&target.destroy(),AppRuntime._unregisterApp(this),_.isFunction(this.runtime.containerView.removeView)&&this.runtime.containerView.removeView(this.view),this.view.destroy()}}},module.exports=RunningApp},"installed_app.js":function(module,exports,require){"use strict";function processRequirements(requirements){return _.reduce(requirements,function(result,requirement){return result[requirement.identifier]={requirement_id:requirement.requirement_id,requirement_type:requirement.requirement_type},result},{})}function processLocations(locations){if(_.isObject(locations)&&!_.isArray(locations))return locations;var locationArray=$.makeArray(locations),locationObj=_.inject(locationArray,function(memo,location){return memo[location]="_legacy",memo},{});return{zendesk:locationObj}}function InstalledApp(appClass,installation){this._runningAppInstances={},this.appClass=appClass,this.sites=processLocations(this.appClass.location),this.dataStore=new DataStore(installation.id),this.updatePromise=null,this.update(installation)}var _=require("underscore"),$=require("jquery"),DataStore=require("storage"),MicroEE=require("microee"),Logger=require("log/base"),logger=new Logger("installed-app"),emitter=new MicroEE,installedApps={},installedAppsForSite={};MicroEE.mixin(InstalledApp),$.extend(InstalledApp.prototype,{add:function(runningApp){var location=runningApp.runtime.getLocation();this._runningAppInstances[location]=this._runningAppInstances[location]||[],this._runningAppInstances[location].push(runningApp)},update:function(installation){var oldInstallation=this.installation,firstRun="undefined"==typeof oldInstallation;return!firstRun&&new Date(this.installation.updated_at)>=new Date(installation.updated_at)?void logger.debug("ignoring update, local updated_at later than what is being updated with %s >= %s",this.installation.updated_at,installation.updated_at):(this.installation=installation,this.enabled="undefined"==typeof installation.servable?installation.enabled:installation.servable,this.requirements=processRequirements(installation.requirements),this.settings=installation.settings,logger.debug("notifying app instances of update",this._runningAppInstances),void(firstRun||oldInstallation.enabled==this.enabled||this.emitEnabledState()))},emitEnabledState:function(){var event=this.enabled?"enabled":"disabled";this.emit(event),"disabled"===event&&InstalledApp.emit(event,this.installation.settings.title,this.installation.disable_reason_code)},requestUpdate:function(){this.updatePromise||(logger.debug("requesting update for installation %s",this.installation.id),this.updatePromise=$.getJSON("/api/v2/apps/installations/"+this.installation.id+".json?include=requirements").then(function(installation){installation.disable_reason&&(logger.debug("updating installation with data:",installation),this.update(installation))}.bind(this)).always(function(){this.updatePromise=null}.bind(this)))},remove:function(runningApp){var location=runningApp.runtime.getLocation(),runningAppsInLocation=this._runningAppInstances[location];runningAppsInLocation&&runningAppsInLocation.splice(runningAppsInLocation.indexOf(runningApp),1)},appsForSite:function(site){return _.map(this._runningAppInstances[site]||[],"app")},sitesFor:function(hostApp){return Object.keys(this.sites[hostApp]||{})}}),InstalledApp.sortAppsForSite=function(site,installationIds){installedAppsForSite[site]=_.reduce(installationIds,function(memo,id){return installedApps[id]&&memo.push(installedApps[id]),memo},[])},InstalledApp.forId=function(installationId){return installedApps[installationId]},InstalledApp.forSite=function(site,hostApp){var installationsCache=installedAppsForSite[site];return hostApp=hostApp||"zendesk",installationsCache||(installationsCache=_.filter(installedApps,function(installed){return-1!==installed.sitesFor(hostApp).indexOf(site)}),installedAppsForSite[site]=installationsCache),installationsCache},InstalledApp.push=function(app,installationData){var installedApp=new InstalledApp(app,installationData);installedApps[installationData.id]=installedApp},InstalledApp.count=function(){return Object.keys(installedApps).filter(function(id){return installedApps[id]instanceof InstalledApp}).length||0},InstalledApp.clear=function(){installedApps={},installedAppsForSite={}},InstalledApp.emit=function(){return emitter.emit.apply(emitter,arguments)},InstalledApp.on=function(){return emitter.on.apply(emitter,arguments)},module.exports=InstalledApp},"core_services.js":function(module){"use strict";var _publicApi={};module.exports={registerServices:function(services){for(var key in services)Object.defineProperty(_publicApi,key,{enumerable:!0,value:services[key]})},publicApi:function(){return _publicApi}}},"events/window.js":function(module,exports,require){"use strict";function eventDispatcherFor(eventName){return eventName=eventName.slice(eventName.lastIndexOf(".")+1),eventDispatcherToEventName[eventName]}function registerWithEventDispatcher(eventDescriptor,wrappedHandler){var eventDispatcher=eventDispatcherFor(eventDescriptor);eventDispatcher&&eventDispatcher.add(wrappedHandler)}function unregisterFromEventDispatcher(eventDescriptor,wrappedHandler){var eventDispatcher=eventDispatcherFor(eventDescriptor);eventDispatcher&&eventDispatcher.remove(wrappedHandler)}function onWindowResize(app,handler){handler.call(app,{width:window.innerWidth,height:window.innerHeight})}function onWindowScroll(app,handler){handler.call(app,{scrollTop:window.scrollTop})}function createWindowEventWrapper(app,eventDescriptor,handler){var eventName=eventDescriptor,wrapper=_utils.noop;return RESIZE_EVENT_REGEXP.test(eventName)?wrapper=_.debounce(onWindowResize.bind(null,app,handler),RESIZE_EVENT_AFTER_MS):SCROLL_EVENT_REGEXP.test(eventName)&&(wrapper=_.debounce(onWindowScroll.bind(null,app,handler),SCROLL_EVENT_AFTER_MS)),wrapper}function WindowEvent(app,descriptor){this.app=app,this.descriptor=descriptor}var _utils=require("utils"),$=require("jquery"),_=require("underscore"),SUPPORTED_WINDOW_EVENTS=["resize","scroll"],RESIZE_EVENT_REGEXP=/\.resize$/,SCROLL_EVENT_REGEXP=/\.scroll$/,RESIZE_EVENT_AFTER_MS=1e3/30,SCROLL_EVENT_AFTER_MS=1e3/60,eventDispatcherToEventName={},initWindowEventDispatchers=_.once(function(){var eventDispatcher;SUPPORTED_WINDOW_EVENTS.forEach(function(eventName){eventDispatcher=$.Callbacks("unique"),eventDispatcherToEventName[eventName]=eventDispatcher,window.addEventListener(eventName,eventDispatcher.fire.bind(eventDispatcher))})});WindowEvent.RESIZE_EVENT_AFTER_MS=RESIZE_EVENT_AFTER_MS,WindowEvent.SCROLL_EVENT_AFTER_MS=SCROLL_EVENT_AFTER_MS,WindowEvent.prototype={bind:function(handler){initWindowEventDispatchers(),this.wrappedHandler=createWindowEventWrapper(this.app,this.descriptor,handler),registerWithEventDispatcher(this.descriptor,this.wrappedHandler)},unbind:function(){unregisterFromEventDispatcher(this.descriptor,this.wrappedHandler)}},module.exports=WindowEvent},"zaf_sdk_client.js":function(module,exports,require){"use strict";function isRequestEvent(eventData){return eventData.key&&eventData.key.match(/^request:/)&&!!eventData.message.url}function trackRegisteredEvent(app,targetUrl,version){var encodedUrl=encodeURIComponent(targetUrl),versionTag="sdk_version:"+version;app.logger.set("app_framework.iframe.registered.url",encodedUrl,["iframe_url:"+encodedUrl,versionTag]),
app.logger.set("app_framework.iframe.registered.app_id",app.id(),[versionTag])}function trackUiRequest(app,request,params){var paramsArray=_.isObject(params)&&!_.isArray(params)?Object.keys(params):$.makeArray(params);paramsArray.forEach(function(param){var uiRequest=app.id()+"-"+request+"-"+param;app.logger.set("app_framework.iframe.ui_request",uiRequest,["ui_request:"+request+"."+param])})}function frameworkIncompatibilityCheck(version){"2.0">version&&console.warn("Apps using ZAF SDK v2 should set framework version to 2.0 on their manifest.")}function onMessageEvent(event){var data=event.data;if(data){if("string"==typeof data)try{data=JSON.parse(data)}catch(e){return}var client=SDKClient.find(data.appGuid);if("iframe.handshake"===data.key)client&&client.deregister(),client=new SDKClient(data.appGuid,data.message,event.source,event.origin),SDKClient.register(client);else{if(!client||!client.isValidEvent(event))return;IFRAME_EVENT.test(data.key)?(frameworkIncompatibilityCheck(client.runningApp.app.frameworkVersion),client.delegateSDKEvent(data)):"request"in data?(frameworkIncompatibilityCheck(client.runningApp.app.frameworkVersion),client.delegateUiRequest(data,data.id)):isRequestEvent(data)?client.delegateAjaxRequest(data):client.delegateEvent(data)}}}function jsonifyError(err){var ret=err;return err instanceof Error&&(ret={code:err.name,msg:err.message},"stack"in err&&(ret.stack=err.stack)),ret}function SDKClient(appGuid,args,target,origin){this.runningApp=AppRuntime.findAppByGuid(appGuid),this.guid=appGuid,this.target=target,this.origin=origin,this.version=args.version,this._pendingPromises={},this.runningApp.app.postMessage=function(key,data){this.postMessage({key:"zaf."+key,message:data})}.bind(this),this.runningApp.app._registeredIframe=!0,this.version>="2.0.0"?this.handshakeV2():this.handshakeV1(),trackRegisteredEvent(this.runningApp.app,this.origin,this.version)}var _=require("underscore"),$=require("jquery"),AppRuntime=require("app_runtime"),EventManager=require("events/event_manager"),HookEvent=require("events/hook"),IFRAME_EVENT=/^iframe\.(on|off|reply):([\w\-\.]+)$/,registeredClients={};SDKClient.prototype.isValidEvent=function(event){return this.origin===event.origin&&this.target===event.source},SDKClient.prototype.postMessage=function(data){return this.target&&this.target.postMessage?("string"!=typeof data&&(data=JSON.stringify(data)),void this.target.postMessage(data,this.origin)):void this.deregister()},SDKClient.prototype.handshakeV2=function(){var app=this.runningApp.app,runtime=AppRuntime.findRuntimeForApp(app),metadata={appId:app.id(),installationId:app.installationId(),settings:app.settings},context=_.extend({host:app.currentHost(),hostAccountId:null,location:app.currentLocation(),instanceGuid:app.__guid},runtime.contextCallback&&runtime.contextCallback(app));app.trigger("app.registered",{context:context,metadata:metadata})},SDKClient.prototype.handshakeV1=function(){var app=this.runningApp.app;app.trigger("app.registered",app.containerContext())},SDKClient.prototype.deregister=function(){this.runningApp.app._registeredIframe=!1,this.runningApp.app.postMessage=null,Object.keys(this._pendingPromises).forEach(function(key){this._pendingPromises[key].reject()}.bind(this)),delete registeredClients[this.guid]},SDKClient.prototype.delegateEvent=function(data){this.runningApp.app.trigger("iframe."+data.key,data.message)},SDKClient.prototype.delegateAjaxRequest=function(data){var app=this.runningApp.app,Request=app.framework().Request,request=new Request(data.key,data.message,app);return request.perform()},SDKClient.prototype.sendError=function(data,error){this.postMessage({id:data.id,error:jsonifyError(error)})},SDKClient.prototype.delegateUiRequest=function(data){var runtime=this.runningApp.runtime,app=this.runningApp.app;trackUiRequest(app,data.request,data.params[0]);try{var ret=runtime.apiRouter.handleRequest(app,data.request,data.params);ret.then(function(result){this.postMessage({id:data.id,result:result})}.bind(this),function(error){this.sendError(data,error)}.bind(this))}catch(exception){app.logger.error(exception),this.sendError(data,exception)}},SDKClient.prototype.delegateSDKEvent=function(data){var evtClass,evt,keyParts=IFRAME_EVENT.exec(data.key),evtType=keyParts[1],evtName=keyParts[2],runtime=this.runningApp.runtime,currentApp=this.runningApp.app,hooksForTypeAndApp=runtime.hooksForType(evtName,currentApp);switch(evtType){case"on":if(evtClass=EventManager.eventFor(evtName),evtClass!==HookEvent)return;if(!_.isEmpty(hooksForTypeAndApp))return void hooksForTypeAndApp[0].subscriberCount++;evt=new evtClass(currentApp,evtName),evt.subscriberCount=1,evt.bind(function(){var dfd=this._pendingPromises[evtName]=$.Deferred();return this.postMessage({key:"zaf."+evtName,needsReply:!0}),dfd.promise()}.bind(this));break;case"off":hooksForTypeAndApp.forEach(function(hook){var unregister=!0;hook.hasOwnProperty("subscriberCount")&&(unregister=--hook.subscriberCount<=0),unregister&&runtime.unregisterHook(hook)});break;case"reply":var promise=this._pendingPromises[evtName];data.error?promise.reject(data.error.msg||!1):promise.resolve(),delete this._pendingPromises[evtName]}},SDKClient.init=function(){window.addEventListener("message",onMessageEvent)},SDKClient.find=function(appGuid){return registeredClients[appGuid]},SDKClient.register=function(client){registeredClients[client.guid]=client},SDKClient.deregister=function(guid){var client=SDKClient.find(guid);client&&client.deregister()},module.exports=SDKClient},"helpers/iframe.js":function(module,exports,require){"use strict";var _utils=require("utils"),Handlebars=require("handlebars"),AppHelpers=require("app_helpers");module.exports=function(){return function(srcUrl){var app=AppHelpers.currentApp,originUrl=window.location.protocol+"//"+window.location.host,params=_utils.fmt("origin=%@&app_guid=%@",encodeURIComponent(originUrl),app.__guid),url=Handlebars.Utils.escapeExpression(srcUrl),html=_utils.fmt('<iframe src="%@"></iframe>',_utils.appendParams(url,params));return new Handlebars.SafeString(html)}}},"events/request.js":function(module,exports,require){"use strict";function RequestEvent(app,descriptor){ViewEvent.call(this,app,descriptor)}var ViewEvent=require("events/view");RequestEvent.prototype=Object.create(ViewEvent.prototype),RequestEvent.prototype.bind=function(handler,view){ViewEvent.prototype.bind.call(this,function(evt,data){return handler.apply(this.app,data&&data.responseArgs)},view)},module.exports=RequestEvent},"helpers/zd_time.js":function(module,exports,require){"use strict";var Handlebars=require("handlebars");module.exports=function(){return function(options){return new Handlebars.SafeString(require("templates/zd_time.hdbs")({attrs:options.hash}))}}},"helpers/spinner.js":function(module,exports,require){"use strict";var _utils=require("utils"),_=require("underscore"),Handlebars=require("handlebars");module.exports=function(){return function(key){return _.isObject(key)&&(key="dotted"),new Handlebars.SafeString(_utils.fmt('<div class="spinner %@"></div>',key))}}},"helpers/zd_date.js":function(module,exports,require){"use strict";var Handlebars=require("handlebars");module.exports=function(){return function(options){return new Handlebars.SafeString(require("templates/zd_date.hdbs")({attrs:options.hash}))}}},"helpers/zd_menu.js":function(module,exports,require){"use strict";function normalizeMenuType(type){return validTypes[type]?type:"select"}var $=require("jquery"),Handlebars=require("handlebars"),compiled=require("templates/zd_menu.hdbs"),validTypes={select:!0,combo_select:!0,search:!1};module.exports=function(){return function(content,options){var type=normalizeMenuType(options.hash.type),data=$.extend({},options,{options:content,type:type});return new Handlebars.SafeString(compiled(data))}}},"app_view/base_v2.js":function(module,exports,require){"use strict";function getClassName(runningApp,classNames){var appClassName=_utils.get(runningApp.app,"appClassName"),locationClassName="apps_"+runningApp.runtime.getLocation();return["app_view",appClassName,locationClassName].concat(classNames||[]).join(" ")}var _utils=require("utils"),_$=require("jquery"),_=require("underscore"),AppView=function(runningApp,options){this.runningApp=runningApp,this.element=document.createElement("div"),this.element.className=getClassName(runningApp,options&&options.classNames),this.inDOM=!1,this.onViewReadyCallbacks=[]};AppView.prototype={$:function(sel){return this.inDOM?this.element&&sel?_$(sel,this.element):_$(this.element):_$()},render:function(el){this.runningApp.app._isNoTemplate()||_$(this.element).html(this.runningApp.app.renderTemplate("layout")),_$(el).append(this.element),this.inDOM=!0,this.onViewReadyCallbacks.forEach(function(callback){_.isFunction(callback)&&callback()})},callWhenReady:function(callback,context){this.inDOM?_.defer(callback.bind(context,this)):this.onViewReadyCallbacks.push(callback.bind(context,this))},destroy:function(){_$(this.element).remove(),this.inDOM=!1}},module.exports=AppView},"helpers/linebreak.js":function(module,exports,require){"use strict";var Handlebars=require("handlebars");module.exports=function(){return function(text){return text=Handlebars.Utils.escapeExpression(text),text=text.replace(/(\r\n|\n|\r)/gm,"<br>"),new Handlebars.SafeString(text)}}},"patched_underscore.js":function(module,exports,require){"use strict";module.exports=function(scope){var _=require("underscore"),Logger=require("log/base"),patches={},underscoreFn=function(){return _.apply(_,arguments)};return patches.template=function(){if(3===arguments.length){var templateString=arguments[0],templateSettings=arguments[2],templateData=arguments[1];return Logger.logger.warn("Please update your app to use the newer version of Underscore's _.template function._.template no longer supports initial data being passed in as the second argument andwill always return a Function!  Documentation can be found here, http://underscorejs.org/#template."),_.template.call(_.template,templateString,templateSettings)(templateData)}return _.template.apply(_.template,arguments)},patches.delay=function(func,wait){var args=Array.prototype.slice.call(arguments,2);return window.ZendeskApps.setTimeout.call(scope,function(){return func.apply(scope,args)},wait)},patches.defer=_.partial(patches.delay,_,1),patches.throttle=function(func,wait,options){var context,args,result,timeout=null,previous=0;options||(options={});var later=function(){previous=options.leading===!1?0:_.now(),timeout=null,result=func.apply(context,args),timeout||(context=args=null)};return function(){var now=_.now();previous||options.leading!==!1||(previous=now);var remaining=wait-(now-previous);return context=this||scope,args=arguments,0>=remaining||remaining>wait?(timeout&&(clearTimeout(timeout),timeout=null),previous=now,result=func.apply(context,args),timeout||(context=args=null)):timeout||options.trailing===!1||(timeout=window.ZendeskApps.setTimeout.call(scope,later,remaining)),result}},patches.debounce=function(func,wait,immediate){var timeout,args,context,timestamp,result,later=function later(){var last=_.now()-timestamp;wait>last&&last>=0?timeout=window.ZendeskApps.setTimeout.call(scope,later,wait-last):(timeout=null,immediate||(result=func.apply(context,args),timeout||(context=args=null)))};return function(){context=this||scope,args=arguments,timestamp=_.now();var callNow=immediate&&!timeout;return timeout||(timeout=window.ZendeskApps.setTimeout.call(scope,later,wait)),callNow&&(result=func.apply(context,args),context=args=null),result}},_.extend(underscoreFn,_,patches)}},"templates/zd_date.hdbs":function(module,exports,require){var Handlebars=require("handlebars");module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var stack1,buffer="";return buffer+=" "+escapeExpression((stack1=null==data||data===!1?data:data.key,typeof stack1===functionType?stack1.apply(depth0):stack1))+'="'+escapeExpression(typeof depth0===functionType?depth0.apply(depth0):depth0)+'"'}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this;return buffer+='<input type="text" data-zd-datepicker="true"',stack1=helpers.each.call(depth0,depth0&&depth0.attrs,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+=" />\n"})},"templates/zd_menu.hdbs":function(module,exports,require){var Handlebars=require("handlebars");module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var stack1,helper,buffer="";return buffer+="\n  <option",stack1=helpers["if"].call(depth0,depth0&&depth0.id,{hash:{},inverse:self.noop,fn:self.program(2,program2,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),stack1=helpers["if"].call(depth0,depth0&&depth0.value,{hash:{},inverse:self.noop,fn:self.program(4,program4,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+=">",(helper=helpers.label)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.label,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</option>\n"}function program2(depth0,data){var stack1,helper,buffer="";return buffer+=' id="',(helper=helpers.id)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.id,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'"'}function program4(depth0,data){var stack1,helper,buffer="";return buffer+=' value="',(helper=helpers.value)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.value,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'"'}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,options,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this,blockHelperMissing=helpers.blockHelperMissing;return buffer+='<select data-zd-type="',(helper=helpers.type)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.type,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'_menu">\n',options={hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data},(helper=helpers.options)?stack1=helper.call(depth0,options):(helper=depth0&&depth0.options,stack1=typeof helper===functionType?helper.call(depth0,options):helper),helpers.options||(stack1=blockHelperMissing.call(depth0,stack1,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data})),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n</select>\n"})},"templates/zd_time.hdbs":function(module,exports,require){var Handlebars=require("handlebars");module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var stack1,buffer="";return buffer+=" "+escapeExpression((stack1=null==data||data===!1?data:data.key,typeof stack1===functionType?stack1.apply(depth0):stack1))+'="'+escapeExpression(typeof depth0===functionType?depth0.apply(depth0):depth0)+'"'}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this;return buffer+='<input type="text" data-zd-timepicker="true"',stack1=helpers.each.call(depth0,depth0&&depth0.attrs,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+=" />\n"})},"wrappers/ticket_type.js":function(module){"use strict";module.exports={0:"ticket",1:"question",2:"incident",3:"problem",4:"task",TICKET:0,QUESTION:1,INCIDENT:2,PROBLEM:3,TASK:4}},"events/event_manager.js":function(module,exports,require){"use strict";function extendEventInterface(eventClass){return eventClass.prototype=_.extend({},EventInterface,eventClass.prototype),eventClass}var _=require("underscore"),descriptorToEventClassMap={},EventInterface={bind:function(){throw Error("Event classes must implement 'bind'")},unbind:function(){}},ConcreteDOMEvent=extendEventInterface(require("events/dom")),EventManager=Object.seal({registerEvents:function(eventMap){for(var key in eventMap)descriptorToEventClassMap[key]=extendEventInterface(eventMap[key])},eventFor:function(descriptor){var type=_.find(Object.keys(descriptorToEventClassMap),function(descriptorRegex){return new RegExp(descriptorRegex).test(descriptor)});return descriptorToEventClassMap[type]||ConcreteDOMEvent}});EventManager.registerEvents({"^\\S+\\.(done|always|fail|delayed)$":require("events/request"),"^ticket\\.save$":require("events/hook"),"^window\\.([a-z]+)$":require("events/window")}),module.exports=EventManager},"app_container/base_v2.js":function(module,exports,require){"use strict";var $=require("jquery"),AppRuntime=require("app_runtime"),AppContainerView=function(options){this.appViews={},this.element=document.createElement("div"),this.element.className="app_container";var runtimeOptions=$.extend({containerView:this},options);this.runtime=new AppRuntime(runtimeOptions)};AppContainerView.prototype={appendView:function(view){this.appViews[view.runningApp.app.__guid]=view,view.render(this.element)},render:function(el){$(el).append(this.element),this.runtime.activate()},getAppView:function(app){return this.appViews[app.__guid]},callWhenEventsReady:function(app,callback){var appView=this.getAppView(app);appView.callWhenReady(callback)},destroy:function(){$(this.element).remove(),this.runtime.destroy()}},module.exports=AppContainerView},"requests/filters/cors.js":function(module,exports,require){"use strict";function corsRequestFilter(request,options){return $.support.cors===!0&&_utils.get(options,"cors")&&(options._metricType="cors",options._stopProcessingFilters=!0),options}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=corsRequestFilter;var _utils=require("utils"),$=require("jquery")},"wrappers/ticket_field.js":function(module){"use strict";module.exports={PRIORITY:"priority",STATUS:"status",TYPE:"type"}},"vendor/uuid_generator.js":function(module){"use strict";for(var lut=[],i=0;256>i;i++)lut[i]=(16>i?"0":"")+i.toString(16);module.exports.generate=function(){var d0=4294967295*Math.random()|0,d1=4294967295*Math.random()|0,d2=4294967295*Math.random()|0,d3=4294967295*Math.random()|0;return lut[255&d0]+lut[d0>>8&255]+lut[d0>>16&255]+lut[d0>>24&255]+"-"+lut[255&d1]+lut[d1>>8&255]+"-"+lut[d1>>16&15|64]+lut[d1>>24&255]+"-"+lut[63&d2|128]+lut[d2>>8&255]+"-"+lut[d2>>16&255]+lut[d2>>24&255]+lut[255&d3]+lut[d3>>8&255]+lut[d3>>16&255]+lut[d3>>24&255]}},"wrappers/ticket_status.js":function(module){"use strict";module.exports={0:"new",1:"open",2:"pending",3:"solved",4:"closed",5:"deleted",6:"hold",NEW:0,OPEN:1,PENDING:2,SOLVED:3,CLOSED:4,DELETED:5,HOLD:6}},"app_runtime_subscriber.js":function(module,exports,require){"use strict";var AppUpdatesSubscriber=require("app_updates_subscriber"),subscribers=[],AppRuntimeSubscriber=function(){AppUpdatesSubscriber.subscribe(),this.enabled=[],this.disabled=[],subscribers.push(this)};AppRuntimeSubscriber.prototype={registerEnabled:function(installation,handler){this.enabled.push({emitter:installation,handler:handler}),installation.on("enabled",handler)},registerDisabled:function(installation,handler){this.disabled.push({emitter:installation,handler:handler}),installation.on("disabled",handler)},destroy:function(){this.enabled.forEach(function(subscriber){subscriber.emitter.removeListener("enabled",subscriber.handler)}.bind(this)),this.enabled=[],this.disabled.forEach(function(subscriber){subscriber.emitter.removeListener("disabled",subscriber.handler)}),this.disabled=[],subscribers.splice(subscribers.indexOf(this),1),0===subscribers.length&&AppUpdatesSubscriber.unsubscribe()}},module.exports=AppRuntimeSubscriber},"background_app_runtime.js":function(module,exports,require){"use strict";function BackgroundAppRuntime(){AppRuntime.apply(this,arguments),this.options.appViewClass=BackgroundAppView}var _utils=require("utils"),AppRuntime=require("app_runtime"),BackgroundAppView=require("app_view/background_view");_utils.extend(BackgroundAppRuntime.prototype,AppRuntime,{}),module.exports=BackgroundAppRuntime},"app_updates_subscriber.js":function(module,exports,require){"use strict";var InstalledApp=require("installed_app"),RadarClient=require("radar_client"),Logger=require("log/base"),logger=new Logger("app-updates-subscriber"),APP_UPDATES_SCOPE="app_updates",APP_INSTALLATION_UPDATES_SCOPE=APP_UPDATES_SCOPE+"/installations",subscribed=!1,handleInstallationUpdate=function(msg){logger.debug("update",msg);var installation=InstalledApp.forId(msg.key);installation?(logger.debug("requesting update for installation",installation),installation.requestUpdate()):logger.debug("ignoring update, app installation not available")},subscribe=function(){!subscribed&&RadarClient&&(logger.debug("subscribing for app updates"),RadarClient.alloc(APP_UPDATES_SCOPE,function(){RadarClient.status(APP_INSTALLATION_UPDATES_SCOPE),RadarClient.status(APP_INSTALLATION_UPDATES_SCOPE).subscribe().on(handleInstallationUpdate)}),subscribed=!0)},unsubscribe=function(){RadarClient&&(logger.debug("unsubscribing from app updates"),RadarClient.status(APP_INSTALLATION_UPDATES_SCOPE).unsubscribe(),RadarClient.dealloc(APP_UPDATES_SCOPE),subscribed=!1)},AppUpdatesSubscriber={subscribe:subscribe,unsubscribe:unsubscribe};module.exports=AppUpdatesSubscriber},"api_handlers/app_runtime.js":function(module,exports,require){"use strict";function resolvePath(path){var matches=/(?:^app\.)?([^:]*)(?::(.*))?/.exec(path);return matches.shift(),_.compact(matches)}function delegateToApp(handlerMap){return function(app,path,params){var result,handler,dfd,resolvedPath,handlerName;return dfd=$.Deferred(),resolvedPath=resolvePath(path),(handlerName=handlerMap[resolvedPath.shift()])?(handler=app[handlerName],"function"==typeof handler?(result=handler.apply(app,resolvedPath.concat(params)),$.Deferred().resolve(result).promise()):dfd.reject().promise()):!1}}var $=require("jquery"),_=require("underscore"),HANDLED_PATHS={actions:{resize:"resize"},getters:{currentLocation:"currentLocation",assetURL:"assetURL",requirement:"requirement"},setters:{}},AppRuntimeApiHandlers={get:delegateToApp(HANDLED_PATHS.getters),invoke:delegateToApp(HANDLED_PATHS.actions)};module.exports=AppRuntimeApiHandlers},"vendor/jquery.timepicker.js":function(module,exports,require){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol?"symbol":typeof obj};!function(factory){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&exports&&"object"===("undefined"==typeof module?"undefined":_typeof(module))&&module&&module.exports===exports?factory(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],factory):factory(jQuery)}(function($){function _isVisible(elem){var el=elem[0];return el.offsetWidth>0&&el.offsetHeight>0}function _parseSettings(settings){if(settings.minTime&&(settings.minTime=_time2int(settings.minTime)),settings.maxTime&&(settings.maxTime=_time2int(settings.maxTime)),settings.durationTime&&"function"!=typeof settings.durationTime&&(settings.durationTime=_time2int(settings.durationTime)),"now"==settings.scrollDefault?settings.scrollDefault=_time2int(new Date):settings.scrollDefault?settings.scrollDefault=_time2int(settings.scrollDefault):settings.minTime&&(settings.scrollDefault=settings.minTime),settings.scrollDefault&&(settings.scrollDefault=_roundTime(settings.scrollDefault,settings)),"string"===$.type(settings.timeFormat)&&settings.timeFormat.match(/[gh]/)&&(settings._twelveHourTime=!0),settings.disableTimeRanges.length>0){for(var i in settings.disableTimeRanges)settings.disableTimeRanges[i]=[_time2int(settings.disableTimeRanges[i][0]),_time2int(settings.disableTimeRanges[i][1])];settings.disableTimeRanges=settings.disableTimeRanges.sort(function(a,b){return a[0]-b[0]});for(var i=settings.disableTimeRanges.length-1;i>0;i--)settings.disableTimeRanges[i][0]<=settings.disableTimeRanges[i-1][1]&&(settings.disableTimeRanges[i-1]=[Math.min(settings.disableTimeRanges[i][0],settings.disableTimeRanges[i-1][0]),Math.max(settings.disableTimeRanges[i][1],settings.disableTimeRanges[i-1][1])],settings.disableTimeRanges.splice(i,1))}return settings}function _render(self){var settings=self.data("timepicker-settings"),list=self.data("timepicker-list");if(list&&list.length&&(list.remove(),self.data("timepicker-list",!1)),settings.useSelect){list=$("<select />",{"class":"ui-timepicker-select"});var wrapped_list=list}else{list=$("<ul />",{"class":"ui-timepicker-list"});var wrapped_list=$("<div />",{"class":"ui-timepicker-wrapper",tabindex:-1});wrapped_list.css({display:"none",position:"absolute"}).append(list)}if(settings.noneOption)if(settings.noneOption===!0&&(settings.noneOption=settings.useSelect?"Time...":"None"),$.isArray(settings.noneOption)){for(var i in settings.noneOption)if(parseInt(i,10)==i){var noneElement=_generateNoneElement(settings.noneOption[i],settings.useSelect);list.append(noneElement)}}else{var noneElement=_generateNoneElement(settings.noneOption,settings.useSelect);list.append(noneElement)}if(settings.className&&wrapped_list.addClass(settings.className),(null!==settings.minTime||null!==settings.durationTime)&&settings.showDuration){{"function"==typeof settings.step?"function":settings.step}wrapped_list.addClass("ui-timepicker-with-duration"),wrapped_list.addClass("ui-timepicker-step-"+settings.step)}var durStart=settings.minTime;"function"==typeof settings.durationTime?durStart=_time2int(settings.durationTime()):null!==settings.durationTime&&(durStart=settings.durationTime);var start=null!==settings.minTime?settings.minTime:0,end=null!==settings.maxTime?settings.maxTime:start+_ONE_DAY-1;start>=end&&(end+=_ONE_DAY),end===_ONE_DAY-1&&"string"===$.type(settings.timeFormat)&&settings.show2400&&(end=_ONE_DAY);var dr=settings.disableTimeRanges,drCur=0,drLen=dr.length,stepFunc=settings.step;"function"!=typeof stepFunc&&(stepFunc=function(){return settings.step});for(var i=start,j=0;end>=i;j++,i+=60*stepFunc(j)){var timeInt=i,timeString=_int2time(timeInt,settings);if(settings.useSelect){var row=$("<option />",{value:timeString});row.text(timeString)}else{var row=$("<li />");row.data("time",86400>=timeInt?timeInt:timeInt%86400),row.text(timeString)}if((null!==settings.minTime||null!==settings.durationTime)&&settings.showDuration){var durationString=_int2duration(i-durStart,settings.step);if(settings.useSelect)row.text(row.text()+" ("+durationString+")");else{var duration=$("<span />",{"class":"ui-timepicker-duration"});duration.text(" ("+durationString+")"),row.append(duration)}}drLen>drCur&&(timeInt>=dr[drCur][1]&&(drCur+=1),dr[drCur]&&timeInt>=dr[drCur][0]&&timeInt<dr[drCur][1]&&(settings.useSelect?row.prop("disabled",!0):row.addClass("ui-timepicker-disabled"))),list.append(row)}if(wrapped_list.data("timepicker-input",self),self.data("timepicker-list",wrapped_list),settings.useSelect)self.val()&&list.val(_roundAndFormatTime(self.val(),settings)),list.on("focus",function(){$(this).data("timepicker-input").trigger("showTimepicker")}),list.on("blur",function(){$(this).data("timepicker-input").trigger("hideTimepicker")}),list.on("change",function(){_setTimeValue(self,$(this).val(),"select")}),_setTimeValue(self,list.val()),self.hide().after(list);else{var appendTo=settings.appendTo;"string"==typeof appendTo?appendTo=$(appendTo):"function"==typeof appendTo&&(appendTo=appendTo(self)),appendTo.append(wrapped_list),_setSelected(self,list),list.on("mousedown","li",function(){self.off("focus.timepicker"),self.on("focus.timepicker-ie-hack",function(){self.off("focus.timepicker-ie-hack"),self.on("focus.timepicker",methods.show)}),_hideKeyboard(self)||self[0].focus(),list.find("li").removeClass("ui-timepicker-selected"),$(this).addClass("ui-timepicker-selected"),_selectValue(self)&&(self.trigger("hideTimepicker"),list.on("mouseup.timepicker","li",function(){list.off("mouseup.timepicker"),wrapped_list.hide()}))})}}function _generateNoneElement(optionValue,useSelect){var label,className,value;return"object"==("undefined"==typeof optionValue?"undefined":_typeof(optionValue))?(label=optionValue.label,className=optionValue.className,value=optionValue.value):"string"==typeof optionValue?label=optionValue:$.error("Invalid noneOption value"),useSelect?$("<option />",{value:value,"class":className,text:label}):$("<li />",{"class":className,text:label}).data("time",value)}function _roundTime(seconds,settings){if($.isNumeric(seconds)||(seconds=_time2int(seconds)),null===seconds)return null;var offset=seconds%(60*settings.step);return offset>=30*settings.step?seconds+=60*settings.step-offset:seconds-=offset,seconds}function _roundAndFormatTime(seconds,settings){return seconds=_roundTime(seconds,settings),null!==seconds?_int2time(seconds,settings):void 0}function _generateBaseDate(){return new Date(1970,1,1,0,0,0)}function _closeHandler(e){var target=$(e.target),input=target.closest(".ui-timepicker-input");0===input.length&&0===target.closest(".ui-timepicker-wrapper").length&&(methods.hide(),$(document).unbind(".ui-timepicker"))}function _hideKeyboard(self){var settings=self.data("timepicker-settings");return(window.navigator.msMaxTouchPoints||"ontouchstart"in document)&&settings.disableTouchKeyboard}function _findRow(self,list,value){if(!value&&0!==value)return!1;var settings=self.data("timepicker-settings"),out=!1,halfStep=30*settings.step;return list.find("li").each(function(i,obj){var jObj=$(obj);if("number"==typeof jObj.data("time")){var offset=jObj.data("time")-value;return Math.abs(offset)<halfStep||offset==halfStep?(out=jObj,!1):void 0}}),out}function _setSelected(self,list){list.find("li").removeClass("ui-timepicker-selected");var timeValue=_time2int(_getTimeValue(self),self.data("timepicker-settings"));if(null!==timeValue){var selected=_findRow(self,list,timeValue);if(selected){var topDelta=selected.offset().top-list.offset().top;(topDelta+selected.outerHeight()>list.outerHeight()||0>topDelta)&&list.scrollTop(list.scrollTop()+selected.position().top-selected.outerHeight()),selected.addClass("ui-timepicker-selected")}}}function _formatValue(e,origin){if(""!==this.value&&"timepicker"!=origin){var self=$(this);if(!self.is(":focus")||e&&"change"==e.type){var settings=self.data("timepicker-settings"),seconds=_time2int(this.value,settings);if(null===seconds)return void self.trigger("timeFormatError");var rangeError=!1;if(null!==settings.minTime&&seconds<settings.minTime?rangeError=!0:null!==settings.maxTime&&seconds>settings.maxTime&&(rangeError=!0),$.each(settings.disableTimeRanges,function(){return seconds>=this[0]&&seconds<this[1]?(rangeError=!0,!1):void 0}),settings.forceRoundTime){var offset=seconds%(60*settings.step);offset>=30*settings.step?seconds+=60*settings.step-offset:seconds-=offset}var prettyTime=_int2time(seconds,settings);rangeError?_setTimeValue(self,prettyTime,"error")&&self.trigger("timeRangeError"):_setTimeValue(self,prettyTime)}}}function _getTimeValue(self){return self.is("input")?self.val():self.data("ui-timepicker-value")}function _setTimeValue(self,value,source){if(self.is("input")){self.val(value);var settings=self.data("timepicker-settings");settings.useSelect&&"select"!=source&&self.data("timepicker-list").val(_roundAndFormatTime(value,settings))}return self.data("ui-timepicker-value")!=value?(self.data("ui-timepicker-value",value),"select"==source?self.trigger("selectTime").trigger("changeTime").trigger("change","timepicker"):"error"!=source&&self.trigger("changeTime"),!0):(self.trigger("selectTime"),!1)}function _keydownhandler(e){
var self=$(this),list=self.data("timepicker-list");if(!list||!_isVisible(list)){if(40!=e.keyCode)return!0;methods.show.call(self.get(0)),list=self.data("timepicker-list"),_hideKeyboard(self)||self.focus()}switch(e.keyCode){case 13:return _selectValue(self)&&methods.hide.apply(this),e.preventDefault(),!1;case 38:var selected=list.find(".ui-timepicker-selected");return selected.length?selected.is(":first-child")||(selected.removeClass("ui-timepicker-selected"),selected.prev().addClass("ui-timepicker-selected"),selected.prev().position().top<selected.outerHeight()&&list.scrollTop(list.scrollTop()-selected.outerHeight())):(list.find("li").each(function(i,obj){return $(obj).position().top>0?(selected=$(obj),!1):void 0}),selected.addClass("ui-timepicker-selected")),!1;case 40:return selected=list.find(".ui-timepicker-selected"),0===selected.length?(list.find("li").each(function(i,obj){return $(obj).position().top>0?(selected=$(obj),!1):void 0}),selected.addClass("ui-timepicker-selected")):selected.is(":last-child")||(selected.removeClass("ui-timepicker-selected"),selected.next().addClass("ui-timepicker-selected"),selected.next().position().top+2*selected.outerHeight()>list.outerHeight()&&list.scrollTop(list.scrollTop()+selected.outerHeight())),!1;case 27:list.find("li").removeClass("ui-timepicker-selected"),methods.hide();break;case 9:methods.hide();break;default:return!0}}function _keyuphandler(e){var self=$(this),list=self.data("timepicker-list");if(!list||!_isVisible(list))return!0;if(!self.data("timepicker-settings").typeaheadHighlight)return list.find("li").removeClass("ui-timepicker-selected"),!0;switch(e.keyCode){case 96:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 65:case 77:case 80:case 186:case 8:case 46:_setSelected(self,list);break;default:return}}function _selectValue(self){var settings=self.data("timepicker-settings"),list=self.data("timepicker-list"),timeValue=null,cursor=list.find(".ui-timepicker-selected");if(cursor.hasClass("ui-timepicker-disabled"))return!1;if(cursor.length&&(timeValue=cursor.data("time")),null!==timeValue)if("string"==typeof timeValue)self.val(timeValue),self.trigger("selectTime").trigger("changeTime").trigger("change","timepicker");else{var timeString=_int2time(timeValue,settings);_setTimeValue(self,timeString,"select")}return!0}function _int2duration(seconds,step){seconds=Math.abs(seconds);var hours,mins,minutes=Math.round(seconds/60),duration=[];return 60>minutes?duration=[minutes,_lang.mins]:(hours=Math.floor(minutes/60),mins=minutes%60,30==step&&30==mins&&(hours+=_lang.decimal+5),duration.push(hours),duration.push(1==hours?_lang.hr:_lang.hrs),30!=step&&mins&&(duration.push(mins),duration.push(_lang.mins))),duration.join(" ")}function _int2time(seconds,settings){if(null!==seconds){var time=new Date(_baseDate.valueOf()+1e3*seconds);if(!isNaN(time.getTime())){if("function"===$.type(settings.timeFormat))return settings.timeFormat(time);for(var hour,code,output="",i=0;i<settings.timeFormat.length;i++)switch(code=settings.timeFormat.charAt(i)){case"a":output+=time.getHours()>11?_lang.pm:_lang.am;break;case"A":output+=time.getHours()>11?_lang.PM:_lang.AM;break;case"g":hour=time.getHours()%12,output+=0===hour?"12":hour;break;case"G":hour=time.getHours(),seconds===_ONE_DAY&&(hour=24),output+=hour;break;case"h":hour=time.getHours()%12,0!==hour&&10>hour&&(hour="0"+hour),output+=0===hour?"12":hour;break;case"H":hour=time.getHours(),seconds===_ONE_DAY&&(hour=24),output+=hour>9?hour:"0"+hour;break;case"i":var minutes=time.getMinutes();output+=minutes>9?minutes:"0"+minutes;break;case"s":seconds=time.getSeconds(),output+=seconds>9?seconds:"0"+seconds;break;case"\\":i++,output+=format.charAt(i);break;default:output+=code}return output}}}function _time2int(timeString,settings){if(""===timeString)return null;if(!timeString||timeString+0==timeString)return timeString;if("object"==("undefined"==typeof timeString?"undefined":_typeof(timeString)))return 3600*timeString.getHours()+60*timeString.getMinutes()+timeString.getSeconds();timeString=timeString.toLowerCase().replace(".",""),("a"==timeString.slice(-1)||"p"==timeString.slice(-1))&&(timeString+="m");var ampmRegex="("+_lang.am.replace(".","")+"|"+_lang.pm.replace(".","")+"|"+_lang.AM.replace(".","")+"|"+_lang.PM.replace(".","")+")?",pattern=new RegExp("^"+ampmRegex+"\\s*([0-2]?[0-9])\\W?([0-5][0-9])?\\W?([0-5][0-9])?\\s*"+ampmRegex+"$"),time=timeString.match(pattern);if(!time)return null;var hour=parseInt(1*time[2],10),ampm=time[1]||time[5],hours=hour;if(12>=hour&&ampm){var isPm=ampm==_lang.pm||ampm==_lang.PM;hours=12==hour?isPm?12:0:hour+(isPm?12:0)}var minutes=1*time[3]||0,seconds=1*time[4]||0,timeInt=3600*hours+60*minutes+seconds;if(!ampm&&settings&&settings._twelveHourTime&&settings.scrollDefault){var delta=timeInt-settings.scrollDefault;0>delta&&delta>=_ONE_DAY/-2&&(timeInt=(timeInt+_ONE_DAY/2)%_ONE_DAY)}return timeInt}var _baseDate=_generateBaseDate(),_ONE_DAY=86400,_lang={am:"am",pm:"pm",AM:"AM",PM:"PM",decimal:".",mins:"mins",hr:"hr",hrs:"hrs"},methods={init:function(options){return this.each(function(){var self=$(this),attributeOptions=[];for(var key in $.fn.timepicker.defaults)self.data(key)&&(attributeOptions[key]=self.data(key));var settings=$.extend({},$.fn.timepicker.defaults,attributeOptions,options);settings.lang&&(_lang=$.extend(_lang,settings.lang)),settings=_parseSettings(settings),self.data("timepicker-settings",settings),self.addClass("ui-timepicker-input"),settings.useSelect?_render(self):(self.prop("autocomplete","off"),self.on("click.timepicker focus.timepicker",methods.show),self.on("change.timepicker",_formatValue),self.on("keydown.timepicker",_keydownhandler),self.on("keyup.timepicker",_keyuphandler),_formatValue.call(self.get(0)))})},show:function(e){var self=$(this),settings=self.data("timepicker-settings");if(e){if(!settings.showOnFocus)return!0;e.preventDefault()}if(settings.useSelect)return void self.data("timepicker-list").focus();_hideKeyboard(self)&&self.blur();var list=self.data("timepicker-list");if(!self.prop("readonly")&&(list&&0!==list.length&&"function"!=typeof settings.durationTime||(_render(self),list=self.data("timepicker-list")),!_isVisible(list))){methods.hide(),list.show();var listOffset={};listOffset.left=settings.orientation.match(/r/)?self.offset().left+self.outerWidth()-list.outerWidth()+parseInt(list.css("marginLeft").replace("px",""),10):self.offset().left+parseInt(list.css("marginLeft").replace("px",""),10);var verticalOrientation;verticalOrientation=settings.orientation.match(/t/)?"t":settings.orientation.match(/b/)?"b":self.offset().top+self.outerHeight(!0)+list.outerHeight()>$(window).height()+$(window).scrollTop()?"t":"b","t"==verticalOrientation?(list.addClass("ui-timepicker-positioned-top"),listOffset.top=self.offset().top-list.outerHeight()+parseInt(list.css("marginTop").replace("px",""),10)):(list.removeClass("ui-timepicker-positioned-top"),listOffset.top=self.offset().top+self.outerHeight()+parseInt(list.css("marginTop").replace("px",""),10)),list.offset(listOffset);var selected=list.find(".ui-timepicker-selected");if(selected.length||(_getTimeValue(self)?selected=_findRow(self,list,_time2int(_getTimeValue(self))):settings.scrollDefault&&(selected=_findRow(self,list,settings.scrollDefault))),selected&&selected.length){var topOffset=list.scrollTop()+selected.position().top-selected.outerHeight();list.scrollTop(topOffset)}else list.scrollTop(0);return $(document).on("touchstart.ui-timepicker mousedown.ui-timepicker",_closeHandler),settings.closeOnWindowScroll&&$(document).on("scroll.ui-timepicker",_closeHandler),self.trigger("showTimepicker"),this}},hide:function(){var self=$(this),settings=self.data("timepicker-settings");return settings&&settings.useSelect&&self.blur(),$(".ui-timepicker-wrapper").each(function(){var list=$(this);if(_isVisible(list)){var self=list.data("timepicker-input"),settings=self.data("timepicker-settings");settings&&settings.selectOnBlur&&_selectValue(self),list.hide(),self.trigger("hideTimepicker")}}),this},option:function(key,value){return this.each(function(){var self=$(this),settings=self.data("timepicker-settings"),list=self.data("timepicker-list");if("object"==("undefined"==typeof key?"undefined":_typeof(key)))settings=$.extend(settings,key);else if("string"==typeof key&&"undefined"!=typeof value)settings[key]=value;else if("string"==typeof key)return settings[key];settings=_parseSettings(settings),self.data("timepicker-settings",settings),list&&(list.remove(),self.data("timepicker-list",!1)),settings.useSelect&&_render(self)})},getSecondsFromMidnight:function(){return _time2int(_getTimeValue(this))},getTime:function(relative_date){var self=this,time_string=_getTimeValue(self);if(!time_string)return null;relative_date||(relative_date=new Date);var offset=_time2int(time_string),time=new Date(relative_date);return time.setHours(offset/3600),time.setMinutes(offset%3600/60),time.setSeconds(offset%60),time.setMilliseconds(0),time},setTime:function(value){var self=this,settings=self.data("timepicker-settings");if(settings.forceRoundTime)var prettyTime=_roundAndFormatTime(value,settings);else var prettyTime=_int2time(_time2int(value),settings);return _setTimeValue(self,prettyTime),self.data("timepicker-list")&&_setSelected(self,self.data("timepicker-list")),this},remove:function(){var self=this;if(self.hasClass("ui-timepicker-input")){var settings=self.data("timepicker-settings");return self.removeAttr("autocomplete","off"),self.removeClass("ui-timepicker-input"),self.removeData("timepicker-settings"),self.off(".timepicker"),self.data("timepicker-list")&&self.data("timepicker-list").remove(),settings.useSelect&&self.show(),self.removeData("timepicker-list"),this}}};$.fn.timepicker=function(method){return this.length?methods[method]?this.hasClass("ui-timepicker-input")?methods[method].apply(this,Array.prototype.slice.call(arguments,1)):this:"object"!==("undefined"==typeof method?"undefined":_typeof(method))&&method?void $.error("Method "+method+" does not exist on jQuery.timepicker"):methods.init.apply(this,arguments):this},$.fn.timepicker.defaults={className:null,minTime:null,maxTime:null,durationTime:null,step:30,showDuration:!1,showOnFocus:!0,timeFormat:"g:ia",scrollDefault:null,selectOnBlur:!1,disableTouchKeyboard:!1,forceRoundTime:!1,appendTo:"body",orientation:"l",disableTimeRanges:[],closeOnWindowScroll:!1,typeaheadHighlight:!0,noneOption:!1,show2400:!1}})},"requests/request_manager.js":function(module,exports,require){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function trackRequestEvent(app,requestName,metricType){var uniqueName=app.id()+requestName.replace(":","-");app.logger.set("app_framework.request_type",uniqueName,["request-type:"+metricType])}function appendFilter(requestFilter){_utils.assert("Request filter must be a function",_.isFunction(requestFilter)),requestFilters.push(requestFilter)}function prependFilter(requestFilter){_utils.assert("Request filter must be a function",_.isFunction(requestFilter)),requestFilters.unshift(requestFilter)}function clearFilters(){requestFilters=[]}function applyFilters(request,options){for(var filters=requestFilters.slice();filters.length;){var filter=filters.shift();if(options=filter(request,options),options._stopProcessingFilters){delete options._stopProcessingFilters;break}}return options}function makeRequest(request,options){return options=applyFilters(request,options),trackRequestEvent(request.app,request.name,options._metricType),delete options._metricType,$.ajax(options)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.appendFilter=appendFilter,exports.prependFilter=prependFilter,exports.clearFilters=clearFilters,exports.applyFilters=applyFilters,exports.makeRequest=makeRequest;var _utils=require("utils"),_same_origin=require("./filters/same_origin"),_same_origin2=_interopRequireDefault(_same_origin),_cors=require("./filters/cors"),_cors2=_interopRequireDefault(_cors),_cross_origin_proxy=require("./filters/cross_origin_proxy"),_cross_origin_proxy2=_interopRequireDefault(_cross_origin_proxy),$=require("jquery"),_=require("underscore"),requestFilters=[];appendFilter(_same_origin2["default"]),appendFilter(_cors2["default"]),appendFilter(_cross_origin_proxy2["default"])},"wrappers/ticket_priority.js":function(module){"use strict";module.exports={0:"-",1:"low",2:"normal",3:"high",4:"urgent",NONE:0,LOW:1,NORMAL:2,HIGH:3,URGENT:4}},"app_view/background_view.js":function(module,exports,require){"use strict";function BackgroundAppView(runningApp){this.runningApp=runningApp,this.element=document.createElement("div")}var _utils=require("utils"),_$=require("jquery"),_=require("underscore"),AppView=require("app_view/base_v2");_utils.extend(BackgroundAppView.prototype,AppView,{$:function(){return _$(this.element)},render:function(){throw new Error("Attempted render from a background app.")},callWhenReady:function(callback,context){_.defer(callback.bind(context,this))}}),module.exports=BackgroundAppView},"wrappers/document_wrapper.js":function(module){"use strict";module.exports=function(document){return{createElement:function(){return document.createElement.apply(document,arguments)}}}},"lib/views/adapters/zd_date.js":function(module,exports,require){"use strict";var $=require("jquery");module.exports=function($view){var $input=$view.find("[data-zd-datepicker]");$input.each(function(){var $el=$(this),$parents=$el.parents(),onScrollHandler=function(){$el.datepicker("hide")};$el.datepicker({beforeShow:function(){$parents.one("scroll",onScrollHandler)},onClose:function(){$el.blur(),$parents.off("scroll",onScrollHandler)}})})}},"lib/views/adapters/zd_time.js":function(module,exports,require){"use strict";require("vendor/jquery.timepicker"),require("stylesheets/jquery.timepicker.css"),require("stylesheets/jquery.timepicker-custom.scss");var $=require("jquery");module.exports=function($view){var $input=$view.find("[data-zd-timepicker]");$input.each(function(){var $el=$(this),lastValidTime="";$el.timepicker({timeFormat:"g:i A"}),$el.one("showTimepicker",function(){$el.data("timepickerList").outerWidth($el.outerWidth())}),$el.on("showTimepicker",function(){var $parents=$el.parents(),onScrollHandler=function(){$el.timepicker("hide")};$parents.one("scroll",onScrollHandler),$el.one("hideTimepicker",function(){$parents.off("scroll",onScrollHandler)})}),$el.on("scroll",function(){lastValidTime=$el.val()}),$el.on("change",function(){lastValidTime=$el.val()}),$el.on("timeFormatError",function(){$el.val(lastValidTime)})})}},"lib/views/adapters/zd_menu.js":function(module,exports,require){"use strict";var _utils=require("utils"),$=require("jquery"),logger=require("log/base").logger;module.exports=function($view){var $items=$view.find("select").filter('[data-zd-type$="_menu"]');0!==$items.length&&logger.benchmark("zd_menu",function(){$items.each(function(i,el){var $el=$(el),type=$el.data("zdType"),pluginName=_utils.fmt("zd_%@",type),pluginFunc=$el[pluginName.camelize()];pluginFunc&&pluginFunc.call($el)})}.bind(this))}},"requests/filters/same_origin.js":function(module,exports){"use strict";function sameOriginRequestFilter(request,options){return request._urlIsLocal(options.url)&&(request._addCustomHeaders(options),options._metricType="same-origin",options._stopProcessingFilters=!0),options}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=sameOriginRequestFilter},"stylesheets/jquery.timepicker.css":function(module){var css=document.createElement("style");css.type="text/css",css.innerHTML=".ui-timepicker-wrapper{overflow-y:auto;height:150px;width:6.5em;background:#fff;border:1px solid #ddd;-webkit-box-shadow:0 5px 10px rgba(0,0,0,0.2);-moz-box-shadow:0 5px 10px rgba(0,0,0,0.2);box-shadow:0 5px 10px rgba(0,0,0,0.2);outline:none;z-index:10001;margin:0}.ui-timepicker-wrapper.ui-timepicker-with-duration{width:13em}.ui-timepicker-wrapper.ui-timepicker-with-duration.ui-timepicker-step-30,.ui-timepicker-wrapper.ui-timepicker-with-duration.ui-timepicker-step-60{width:11em}.ui-timepicker-list{margin:0;padding:0;list-style:none}.ui-timepicker-duration{margin-left:5px;color:#888}.ui-timepicker-list:hover .ui-timepicker-duration{color:#888}.ui-timepicker-list li{padding:3px 0 3px 5px;cursor:pointer;white-space:nowrap;color:#000;list-style:none;margin:0}.ui-timepicker-list:hover .ui-timepicker-selected{background:#fff;color:#000}li.ui-timepicker-selected,.ui-timepicker-list li:hover,.ui-timepicker-list .ui-timepicker-selected:hover{background:#1980EC;color:#fff}li.ui-timepicker-selected .ui-timepicker-duration,.ui-timepicker-list li:hover .ui-timepicker-duration{color:#ccc}.ui-timepicker-list li.ui-timepicker-disabled,.ui-timepicker-list li.ui-timepicker-disabled:hover,.ui-timepicker-list li.ui-timepicker-selected.ui-timepicker-disabled{color:#888;cursor:default}.ui-timepicker-list li.ui-timepicker-disabled:hover,.ui-timepicker-list li.ui-timepicker-selected.ui-timepicker-disabled{background:#f2f2f2}\n",document.getElementsByTagName("head")[0].appendChild(css),module.exports=css},"wrappers/ticket_post_save_action.js":function(module){"use strict";module.exports={CLOSE_TAB:"close_tab",NEXT_TICKET:"next_ticket",NEXT_PLAY_TICKET:"next_play_ticket",STAY_ON_TICKET:"stay_on_ticket"}},"requests/filters/cross_origin_proxy.js":function(module,exports,require){"use strict";function mungeOptionsForProxy(request,options){if(_.isFunction(request._mungeOptionsForProxy))return request._mungeOptionsForProxy.call(request,options);var params,result=$.extend({},options),oauth=_utils.get(options,"oauth"),secure=_utils.get(options,"secure"),destinationUrl="/proxy/to/%@",isGet=void 0===options.type||"GET"===options.type,originalUrl=options.url;return oauth?destinationUrl="/proxy/apps/oauth/%@":secure&&(destinationUrl="/proxy/apps/secure/%@"),isGet&&options.data&&(params=decodeURIComponent($.param(options.data)),delete result.data,originalUrl=_utils.appendParams(originalUrl,params)),result.url=_utils.fmt(destinationUrl,[encodeURIComponent(originalUrl)]),result._metricType="pass-through-proxy",request._addCustomHeaders(result),result}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=mungeOptionsForProxy;var _utils=require("utils"),$=require("jquery"),_=require("underscore")},"stylesheets/jquery.timepicker-custom.scss":function(module){var css=document.createElement("style");css.type="text/css",css.innerHTML=".ui-timepicker-list li{background:#fff;color:#666}.ui-timepicker-list li:hover,.ui-timepicker-list li.ui-timepicker-selected,.ui-timepicker-list li.ui-timepicker-selected:hover{background:#e9e9e9;color:#222222}\n",document.getElementsByTagName("head")[0].appendChild(css),module.exports=css}},r.m[1]={radar_client:function(module){module.exports=window.RadarClient},minilog:function(module){module.exports=window.Minilog},ember:function(module){module.exports=window.Ember},handlebars:function(module){module.exports=window.Handlebars},i18n:function(module){module.exports=window.I18n},jquery:function(module){module.exports=window.jQuery},reporter:function(module){module.exports=window.ZendeskReporter},underscore:function(module){module.exports=window._},"index.js":function(module){"use strict";function M(){this._events={}}M.prototype={on:function(ev,cb){this._events||(this._events={});var e=this._events;return(e[ev]||(e[ev]=[])).push(cb),this},removeListener:function(ev,cb){var i,e=this._events[ev]||[];for(i=e.length-1;i>=0&&e[i];i--)(e[i]===cb||e[i].cb===cb)&&e.splice(i,1)},removeAllListeners:function(ev){ev?this._events[ev]&&(this._events[ev]=[]):this._events={}},listeners:function(ev){return this._events?this._events[ev]||[]:[]},emit:function(ev){this._events||(this._events={});var i,args=Array.prototype.slice.call(arguments,1),e=this._events[ev]||[];for(i=e.length-1;i>=0&&e[i];i--)e[i].apply(this,args);return this},when:function(ev,cb){return this.once(ev,cb,!0)},once:function(ev,cb,when){function c(){when||this.removeListener(ev,c),cb.apply(this,arguments)&&when&&this.removeListener(ev,c)}return cb?(c.cb=cb,this.on(ev,c),this):this}},M.mixin=function(dest){var k,o=M.prototype;for(k in o)o.hasOwnProperty(k)&&(dest.prototype[k]=o[k])},module.exports=M}},ZendeskApps=r("index.js")}();
//# sourceMappingURL=framework.min.js.map